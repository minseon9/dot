"use strict";var In=Object.create;var _e=Object.defineProperty;var Kn=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var kn=Object.getPrototypeOf,Pn=Object.prototype.hasOwnProperty;var V=(d,e)=>()=>(d&&(e=d(d=0)),e);var Dn=(d,e)=>()=>(e||d((e={exports:{}}).exports,e),e.exports),wn=(d,e)=>{for(var t in e)_e(d,t,{get:e[t],enumerable:!0})},$t=(d,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Fn(e))!Pn.call(d,r)&&r!==t&&_e(d,r,{get:()=>e[r],enumerable:!(n=Kn(e,r))||n.enumerable});return d};var ie=(d,e,t)=>(t=d!=null?In(kn(d)):{},$t(e||!d||!d.__esModule?_e(t,"default",{value:d,enumerable:!0}):t,d)),Nn=d=>$t(_e({},"__esModule",{value:!0}),d);function ft(){if(pt===void 0)throw new Error("tsserverlibrary not loaded yet");return pt}var pt,A,z=V(()=>{"use strict";(e=>{function d(t){pt=t}e.install=d})(ft||={});A=ft});var re=Dn((Zn,Qt)=>{"use strict";z();var i=A(),mt=function*(){}(),Wt;(q=>{let d=i;q.getTokenAtPosition=d.getTokenAtPosition,q.getTouchingToken=d.getTouchingToken,q.getNameTable=d.getNameTable,q.findReferencedSymbols=d.findReferencedSymbols,q.getSymbolId=d.getSymbolId;function s(D,a){let u=q.getTokenAtPosition(D,a);if(u.kind===i.SyntaxKind.EndOfFileToken){let y=u,p=a;for(;y.kind===i.SyntaxKind.EndOfFileToken&&p>0;)y=q.getTokenAtPosition(D,--p);return y.kind===i.SyntaxKind.EndOfFileToken?{token:u}:{previous:y,token:u}}let m={token:u},h=!0;if(a>u.getStart(D))m.touching=u,h=!1;else if(a<u.getStart(D)){let y=u.parent;for(;y!==void 0;){if(a>=y.getStart(D)){m.touching=y;break}y=y.parent}}if(h){let y=u;for(;y.parent;){let p=b.getChildren(y.parent,D),g=l(p,y);if(g>0){let C=p[g-1],F=b.getChildren(C,D);for(;F.length>0;){let T=F[F.length-1];if(T.kind===i.SyntaxKind.EndOfFileToken)break;C=T,F=b.getChildren(C,D)}if(C.kind!==i.SyntaxKind.EndOfFileToken){m.previous=C;break}}y=y.parent}}return m}q.getRelevantTokens=s;function l(D,a){let u=0,m=D.length-1;for(;u<=m;){let h=Math.floor((u+m)/2),y=D[h].getStart(),p=a.getStart();if(y===p)return D[h]===a?h:-1;y<p?u=h+1:m=h-1}return-1}let c;(a=>{function D(u){let m=u.getCompilerOptions();if(typeof m.project=="string")return m.project;let h=m.configFilePath;return typeof h=="string"?h:void 0}a.getKey=D})(c=q.Programs||={});class f{cancellationToken;end;constructor(a,u,m,h=!1){this.cancellationToken=h?void 0:a,this.end=h?Number.MAX_VALUE:u+m}isCancellationRequested(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()?!0:Date.now()>this.end}isTimedOut(){return Date.now()>this.end}throwIfCancellationRequested(){if(this.isCancellationRequested())throw new i.OperationCanceledException}}q.CancellationTokenWithTimer=f;class S{isCancellationRequested(){return!1}throwIfCancellationRequested(){}}q.NullCancellationToken=S;let b;(h=>{function D(y,p){if(i.isSourceFile(y)){let g=y.getChildren(p);return g.length>0&&g[0].kind===i.SyntaxKind.SyntaxList?g[0].getChildren(p):y.statements}else return y.getChildren(p)}h.getChildren=D;function a(y){return y.symbol}h.getSymbol=a;function u(y){if(i.isTypeReferenceNode(y))return y.typeName.getText()}h.getTypeName=u;function m(y,p){let g=y;for(;g!==void 0;){if(g.kind===p)return g;g=g.parent}}h.getParentOfKind=m})(b=q.Nodes||={});let x;(a=>{function D(u){return(i.getCombinedModifierFlags(u)&i.ModifierFlags.Private)!==0}a.isPrivate=D})(x=q.Declarations||={});let R;(h=>{let D;(p=>p[p.topLevel=0]="topLevel")(D=h.Mode||={});function a(y){let p=y.kind;return p===i.SyntaxKind.InterfaceDeclaration||p===i.SyntaxKind.ClassDeclaration}h.is=a;function u(y,p=0){return m(y.statements)}h.entries=u;function*m(y){for(let p of y)i.isClassDeclaration(p)||i.isInterfaceDeclaration(p)?yield p:i.isModuleDeclaration(p)&&p.body!==void 0&&i.isModuleBlock(p.body)&&(yield*m(p.body.statements))}})(R=q.TypeDeclarations||={});let w;(h=>{function D(y){let p=y.heritageClauses;if(p!==void 0)return p.find(g=>g.token===i.SyntaxKind.ExtendsKeyword)}h.getExtendsClause=D;function a(y){return u(y.statements)}h.entries=a;function*u(y){for(let p of y)i.isClassDeclaration(p)?yield p:i.isModuleDeclaration(p)&&p.body!==void 0&&i.isModuleBlock(p.body)&&(yield*u(p.body.statements))}function m(y){if(!I.isClass(y))return;let p=y.getDeclarations();if(p!==void 0){for(let g of p)if(i.isClassDeclaration(g))return g}}h.fromSymbol=m})(w=q.ClassDeclarations||={});let X;(a=>{function D(u,m,h,y,p){let g=u;if(typeof g.getAccessibleSymbolChain=="function")return g.getAccessibleSymbolChain(m,h,y,p)}a.getAccessibleSymbolChain=D})(X=q.TypeChecker||={});let W;(h=>{function D(y){return(y.flags&i.TypeFlags.Intersection)!==0}h.isIntersection=D;function a(y){return(y.flags&i.TypeFlags.Union)!==0}h.isUnion=a;function u(y){return y.getBaseTypes()}h.getBaseTypes=u;function m(y,p){let g=p.getSymbol();if(g===void 0)return;let C=g.getDeclarations();if(C===void 0)return;let F=[];for(let T of C)if(i.isClassDeclaration(T)){let k=T.heritageClauses;if(k!==void 0)for(let O of k)for(let de of O.types)F.push(y.getTypeAtLocation(de.expression))}return F}h.getExtendsTypes=m})(W=q.Types||={});let E;(a=>{function D(u,m,h,y){let p=u;typeof p.runWithTemporaryFileUpdate=="function"&&p.runWithTemporaryFileUpdate(m,h,y)}a.runWithTemporaryFileUpdate=D})(E=q.LanguageServiceHost||={});let M;(u=>(u.depthFirst="depthFirst",u.breadthFirst="breadthFirst"))(M=q.Traversal||={});let Ke;(a=>a.breadthFirstOnly="breadthFirstOnly")(Ke||={});class te{start;mode;symbols;constructor(a,u,m){this.start=a,this.mode=u,this.symbols=m}isValid(){return I.isClass(this.start)}isValidDeclaration(a){return i.isClassDeclaration(a)}*getDeclarations(a){yield*w.entries(a)}isSubType(a,u){return this.symbols.isSubClass(a,u)}with(a){return new te(a,this.mode,this.symbols)}}class ne{start;mode;symbols;constructor(a,u,m){this.start=a,this.mode=u,this.symbols=m}isValid(){return I.isClass(this.start)||I.isInterface(this.start)||I.isTypeAlias(this.start)}isValidDeclaration(a){return R.is(a)||i.isTypeAliasDeclaration(a)}*getDeclarations(a){yield*R.entries(a,0)}isSubType(a,u){return this.symbols.isSubType(a,u)}with(a){return new ne(a,this.mode,this.symbols)}}class I{program;typeChecker;constructor(a){this.program=a,this.typeChecker=a.getTypeChecker()}static Unknown="unknown";static Undefined="undefined";static None="none";static getParent(a){return a.parent}static isFunctionScopedVariable(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.FunctionScopedVariable)!==0}static isBlockScopedVariable(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.BlockScopedVariable)!==0}static isConstructor(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Constructor)!==0}static isGetAccessor(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.GetAccessor)!==0}static isSetAccessor(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.SetAccessor)!==0}static isMethod(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Method)!==0}static isProperty(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Property)!==0}static isClass(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Class)!==0}static isObjectLiteral(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.ObjectLiteral)!==0}static isInterface(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Interface)!==0}static isTypeAlias(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.TypeAlias)!==0}static isTypeParameter(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.TypeParameter)!==0}static isTypeLiteral(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.TypeLiteral)!==0}static isAlias(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Alias)!==0}static isFunction(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Function)!==0}static isValueModule(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.ValueModule)!==0}static isNamespaceModule(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.NamespaceModule)!==0}static isEnum(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Enum)!==0}static isRegularEnum(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.RegularEnum)!==0}static isConstEnum(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.ConstEnum)!==0}static isSignature(a){return a!==void 0&&(a.getFlags()&i.SymbolFlags.Signature)!==0}static hasModifierFlags(a,u){let m=a.declarations;if(m!==void 0){for(let h of m)if((i.getCombinedModifierFlags(h)&u)===0)return!1}return!0}static isAbstract(a){return this.hasModifierFlags(a,i.ModifierFlags.Abstract)}static isStatic(a){return this.hasModifierFlags(a,i.ModifierFlags.Static)}static isPrivate(a){return this.hasModifierFlags(a,i.ModifierFlags.Private)}static internalSymbolNames;static isInternal(a){if(this.internalSymbolNames===void 0){this.internalSymbolNames=new Set;for(let u in i.InternalSymbolName)this.internalSymbolNames.add(i.InternalSymbolName[u])}return this.internalSymbolNames.has(a.escapedName)}static isSourceFile(a){let u=a.getDeclarations();return u!==void 0&&u.length===1&&i.isSourceFile(u[0])}static fillSources(a,u){if(u.declarations!==void 0)for(let m of u.declarations){let h=m.getSourceFile();h!==void 0&&a.add(h.fileName)}}static getPrimarySourceFile(a){let u=a.declarations;if(!(u===void 0||u.length===0))return u[0].getSourceFile()}static getDeclaration(a,u){let m=a.getDeclarations();if(!(m===void 0||m.length===0)){for(let h of m)if(h.kind===u)return h}}static createKey(a,u){let m=a.getDeclarations();if(m===void 0)return;let h=[];for(let p of m){let g=p.getSourceFile();h.push({f:g.fileName,s:p.getStart(),e:p.getEnd(),k:p.kind})}h.length>1&&h.sort((p,g)=>{let C=p.f<g.f?-1:p.f>g.f?1:0;return C!==0||(C=p.s-g.s,C!==0)||(C=p.e-g.e,C!==0)?C:p.k-g.k});let y=u.createHash("md5");return(a.flags&i.SymbolFlags.Transient)!==0&&y.update(JSON.stringify({trans:!0},void 0,0)),y.update(JSON.stringify(h,void 0,0)),y.digest("base64")}static createVersionedKey(a,u){let m=a.getDeclarations();if(m===void 0)return;let h=[];for(let p of m){let g=p.getSourceFile(),C=u.getScriptVersion(g);if(C===void 0)return;h.push({f:g.fileName,v:C,s:p.getStart(),e:p.getEnd(),k:p.kind})}h.length>1&&h.sort((p,g)=>{let C=p.f<g.f?-1:p.f>g.f?1:0;return C!==0||(C=p.v<g.v?-1:p.v>g.v?1:0,C!==0)||(C=p.s-g.s,C!==0)||(C=p.e-g.e,C!==0)?C:p.k-g.k});let y=u.host.createHash("md5");return(a.flags&i.SymbolFlags.Transient)!==0&&y.update(JSON.stringify({trans:!0},void 0,0)),y.update(JSON.stringify(h,void 0,0)),y.digest("base64")}getFullyQualifiedSymbolName(a){let u=a.getDeclarations();if(u===void 0||u.length===0)return;let m=u[0].getSourceFile();for(let p=1;p<u.length;p++)if(u[p].getSourceFile()!==m)return;if(this.getSymbolAtLocation(m)===void 0)return;let h=[],y=a;for(;y!==void 0;){let p=y.declarations;if(p===void 0||p.length===0)return;if(p.length===1&&i.isSourceFile(p[0]))break;h.push(this.getExportSymbolName(y)),y=I.getParent(y)}return h.length===0?void 0:`${h.reverse().join(".")}`}static escapeRegExp=new RegExp("\\.","g");getExportSymbolName(a){let u=a.getEscapedName();return(u.charAt(0)==='"'||u.charAt(0)==="'")&&(u=u.substr(1,u.length-2)),u=u.replace(I.escapeRegExp,".."),u}getProgram(){return this.program}getTypeChecker(){return this.typeChecker}getSymbolAtLocation(a){let u=this.typeChecker.getSymbolAtLocation(a);return u===void 0&&(u=b.getSymbol(a)),u}getExtendsSymbol(a){let u=a.declarations;if(u===void 0)return[void 0,void 0];for(let m of u)if(i.isClassDeclaration(m)){let h=m.heritageClauses;if(h!==void 0){for(let y of h)if(y.token===i.SyntaxKind.ExtendsKeyword){let p=y.types[0]?.expression,g=this.typeChecker.getSymbolAtLocation(p);if(I.isAlias(g)&&(g=this.typeChecker.getAliasedSymbol(g)),I.isClass(g))return[g,p.getText()]}}}return[void 0,void 0]}getDirectSuperSymbols(a){let u=a.declarations;if(u===void 0)return;let m={};for(let h of u)if(i.isClassDeclaration(h)){let y=h.heritageClauses;if(y!==void 0)for(let p of y){let g=p.types[0]?.expression,C=this.typeChecker.getSymbolAtLocation(g);I.isAlias(C)&&(C=this.typeChecker.getAliasedSymbol(C)),p.token===i.SyntaxKind.ExtendsKeyword?I.isClass(C)&&(m.extends={symbol:C,name:g.getText()}):p.token===i.SyntaxKind.ImplementsKeyword&&I.isInterface(C)&&(m.implements===void 0&&(m.implements=[]),m.implements.push({symbol:C,name:g.getText()}))}}return m}getAliasedSymbolAtLocation(a){let u=this.getSymbolAtLocation(a);if(u!==void 0)return I.isAlias(u)?this.typeChecker.getAliasedSymbol(u):u}getLeafSymbolAtLocation(a){let u=this.getSymbolAtLocation(a);if(u!==void 0)return this.getLeafSymbol(u)}getSymbolAtTypeNodeLocation(a){return i.isTypeReferenceNode(a)?this.getLeafSymbolAtLocation(a.typeName):i.isTypeLiteralNode(a)?this.getLeafSymbolAtLocation(a):this.getLeafSymbolAtLocation(a)}getAliasedSymbol(a){return I.isAlias(a)?this.typeChecker.getAliasedSymbol(a):a}getLeafSymbol(a){let u=0;for(;I.isAlias(a)&&u++<10;)a=this.typeChecker.getAliasedSymbol(a);for(;I.isTypeAlias(a)&&u++<10;){let m=a.declarations;if(m===void 0||m.length!==1)break;let h=m[0];if(!i.isTypeAliasDeclaration(h))break;let y=this.getSymbolAtLocation(h.type);if(y===void 0)break;a=y}return a}getAllSuperTypes(a,u="depthFirst"){return this._getAllSuperTypes(a,u,new Set,!1)}getAllSuperTypesWithPath(a,u="depthFirst"){return this._getAllSuperTypes(a,u,new Set,!0)}getDirectSuperTypes(a){return this._getAllSuperTypes(a,"breadthFirstOnly",new Set,!1)}*_getAllSuperTypes(a,u,m,h){let y=[a];for(;y.length>0;){let p=y.pop();if(I.isAlias(p)&&(m.add(p),p=this.typeChecker.getAliasedSymbol(p)),I.isClass(p)||I.isInterface(p)){let g=p.declarations;if(g===void 0)return;for(let C of g){let F;if((i.isClassDeclaration(C)||i.isInterfaceDeclaration(C))&&(F=C.heritageClauses),F!==void 0)for(let T of F)for(let k of T.types){let O=this.getAliasedSymbolAtLocation(k.expression);O!==void 0&&!m.has(O)&&(m.add(O),yield h?[p,O]:O,u==="depthFirst"?yield*this._getAllSuperTypes(O,u,m,h):u==="breadthFirst"&&y.push(O))}}}else if(I.isTypeAlias(p)){let g=p.declarations;if(g===void 0)return;for(let C of g)if(i.isTypeAliasDeclaration(C)){let F=C.type;if(i.isTypeLiteralNode(F)){let T=this.getAliasedSymbolAtLocation(F);T!==void 0&&!m.has(T)&&(m.add(T),yield h?[p,T]:T)}else if(i.isTypeReferenceNode(F)){let T=this.getAliasedSymbolAtLocation(F.typeName);T!==void 0&&!m.has(T)&&(m.add(T),yield h?[p,T]:T,u==="depthFirst"?yield*this._getAllSuperTypes(T,u,m,h):u==="breadthFirst"&&y.push(T))}else if(i.isIntersectionTypeNode(F))for(let T of F.types){let k=this.getSymbolAtTypeNodeLocation(T);k!==void 0&&!m.has(k)&&(I.isTypeLiteral(k)?(m.add(k),yield h?[p,k]:k):I.isTypeAlias(k)?(m.add(k),u==="depthFirst"?yield*this._getAllSuperTypes(k,u,m,h):u==="breadthFirst"&&y.push(k)):(m.add(k),yield h?[p,k]:k,u==="depthFirst"?yield*this._getAllSuperTypes(k,u,m,h):u==="breadthFirst"&&y.push(k)))}}}}}getAllSuperClasses(a){return this._getAllSuperClasses(a,new Set)}*_getAllSuperClasses(a,u){if(!I.isClass(a))return;let m=[a];for(;m.length>0;){let y=m.pop().declarations;if(y!==void 0)for(let p of y){if(!i.isClassDeclaration(p))continue;let g=p.heritageClauses;if(g!==void 0)for(let C of g){if(C.token!==i.SyntaxKind.ExtendsKeyword||C.types.length<1)continue;let F=C.types[0],T=this.getAliasedSymbolAtLocation(F.expression);T!==void 0&&!u.has(T)&&(u.add(T),yield T,m.push(T))}}}}isSubType(a,u){if(a.heritageClauses===void 0)return!1;for(let m of a.heritageClauses)for(let h of m.types){let y=this.getAliasedSymbolAtLocation(h.expression);if(y!==void 0&&y===u)return!0}return!1}isSubClass(a,u){if(a.heritageClauses===void 0)return!1;for(let m of a.heritageClauses){if(m.token!==i.SyntaxKind.ExtendsKeyword)continue;if(m.types.length<1)return!1;let h=this.getAliasedSymbolAtLocation(m.types[0].expression);if(h!==void 0&&h===u)return!0}return!1}getDirectSubTypes(a,u,m,h){let y=I.isClass(a)?new te(a,"breadthFirstOnly",this):I.isInterface(a)||I.isTypeAlias(a)?new ne(a,"breadthFirstOnly",this):void 0;return y===void 0?mt:this._getAllSubTypes(y,u,m,new Set,h)}getAllSubTypes(a,u="depthFirst",m,h,y){let p=I.isClass(a)?new te(a,u,this):I.isInterface(a)||I.isTypeAlias(a)?new ne(a,u,this):void 0;return p===void 0?mt:this._getAllSubTypes(p,m,h,new Set,y)}*_getAllSubTypes(a,u,m,h,y){if(!a.isValid())return;let p=[a.start];for(;p.length>0;){let g=p.pop(),C=g.declarations;if(C===void 0||C.length===0)return;for(let F of C){if(!a.isValidDeclaration(F))continue;let T=new Tn(this.program,F.getSourceFile(),u,m,y);for(let k of T)for(let O of a.getDeclarations(k)){let de=this.getAliasedSymbolAtLocation(O.name?O.name:O);de===void 0||h.has(de)||a.isSubType(O,g)&&(h.add(de),yield de,a.mode==="depthFirst"?yield*this._getAllSubTypes(a.with(de),u,m,h,y):a.mode==="breadthFirst"&&p.push(de))}}}}getMemberStatistic(a){let u=new Set,m=new Set;I._getMemberStatistic(u,m,a);for(let h of this.getAllSuperTypes(a))I._getMemberStatistic(u,m,h);return{abstract:u,concrete:m}}static _getMemberStatistic(a,u,m){if(I.isClass(m)){let h=m.declarations;if(h===void 0)return;for(let y of h)if(i.isClassDeclaration(y))for(let p of y.members)if(i.isMethodDeclaration(p)||i.isGetAccessorDeclaration(p)||i.isSetAccessorDeclaration(p)||i.isPropertyDeclaration(p)){let g=p.name.getText();I.includesAbstract(p.modifiers)&&!u.has(g)?a.add(g):u.add(g)}else i.isIndexSignatureDeclaration(p)&&(I.includesAbstract(p.modifiers)&&!u.has("[]")?a.add("[]"):u.add("[]"))}else if((I.isInterface(m)||I.isTypeLiteral(m))&&m.members!==void 0)for(let h of m.members.values())u.has(h.name)||a.add(h.name)}static includesAbstract(a){return a===void 0?!1:a.some(u=>u.kind===i.SyntaxKind.AbstractKeyword)}}q.Symbols=I;let Cn;(m=>{function D(h){return h.projectService}m.getProjectService=D;function a(h,y){let p=h;if(typeof p.getFileAndProject=="function")return p.getFileAndProject(y)}m.getFileAndProject=a;function u(h,y,p){let g=h;if(typeof g.getPositionInFile=="function")return g.getPositionInFile(y,p)}m.getPositionInFile=u})(Cn=q.Sessions||={});function Rn(D){return D.moduleReference.kind===i.SyntaxKind.ExternalModuleReference&&D.moduleReference.expression.kind===i.SyntaxKind.StringLiteral}class Wn{key;traversed;complete;outdated;importedBy;outdatedImportedBy;constructor(a){this.key=a,this.complete=!1,this.outdated=!1,this.traversed=new Set,this.importedBy=new Map,this.outdatedImportedBy=void 0}isComplete(){return this.complete}markComplete(){this.complete=!0,this.outdated=!1,this.outdatedImportedBy=void 0}addTraversed(a){this.traversed.add(a.fileName)}isTraversed(a){return this.traversed.has(a.fileName)}hasTraversed(){return this.traversed.size>0}imports(a,u){let m=this.importedBy.get(u.fileName);m===void 0&&(m=new Set,this.importedBy.set(u.fileName,m)),m.add(a.fileName)}getImportedBy(a,u){let m=this.importedBy.get(a.fileName);return m===void 0&&u&&(m=this.outdatedImportedBy?.get(a.fileName)),m===void 0?mt:m.values()}markAsOutdated(){this.outdated=!0,this.outdatedImportedBy=this.importedBy,this.importedBy=new Map}isOutdated(){return this.outdated}}q.ImportedByState=Wn;class Tn{program;sourceFile;preferredSourceFiles;token;importedByState;constructor(a,u,m,h,y){this.program=a,this.sourceFile=u,this.preferredSourceFiles=m,this.token=y;let p=q.Programs.getKey(a);this.importedByState=p!==void 0?h.getImportedByState(p):void 0}getSourceFile(a){return this.program.getSourceFile(a)}[Symbol.iterator](){return this.entries()}*entries(){this.token.throwIfCancellationRequested();let a=this.program;if(this.importedByState!==void 0){for(let p of this.importedByState.getImportedBy(this.sourceFile,!0)){this.token.throwIfCancellationRequested();let g=this.getSourceFile(p);g!==void 0&&!this.skipSourceFile(a,g)&&(yield g)}if(this.importedByState.isComplete()&&!this.importedByState.isOutdated())return}function u(p){return p.kind===i.SyntaxKind.ModuleDeclaration&&p.name.kind===i.SyntaxKind.StringLiteral}function m(p,g){let C=p.getSymbolAtLocation(g);if(!(C===void 0||!I.isSourceFile(C)))return C.declarations[0]}let h=a.getTypeChecker(),y=h.getSymbolAtLocation(this.sourceFile);if(y!==void 0)for(let p of this.allSourceFiles()){if(this.token.throwIfCancellationRequested(),this.sourceFile===p){yield p;continue}if(!this.skipSourceFile(a,p))if(p.externalModuleIndicator&&p.imports!==void 0)for(let g=0;g<p.imports.length;g++){this.token.throwIfCancellationRequested();let C=h.getSymbolAtLocation(p.imports[g]);if(C===y){if(this.importedByState!==void 0){this.importedByState.imports(p,this.sourceFile);for(let F=g+1;F<p.imports.length;F++){let T=m(h,p.imports[g]);T!==void 0&&!this.skipSourceFile(a,T)&&this.importedByState?.imports(p,T)}}yield p;break}else if(C!==void 0&&I.isSourceFile(C)){let F=C.declarations[0];this.skipSourceFile(a,F)||this.importedByState?.imports(p,F)}}else{let g=p,C=g.kind===i.SyntaxKind.SourceFile?g.statements:g.body.statements,F=T=>{switch(T.kind){case i.SyntaxKind.ExportDeclaration:case i.SyntaxKind.ImportDeclaration:{let k=T;if(k.moduleSpecifier&&i.isStringLiteral(k.moduleSpecifier)&&h.getSymbolAtLocation(k.moduleSpecifier)===y)return!0;break}case i.SyntaxKind.ImportEqualsDeclaration:{let k=T;if(Rn(k)&&h.getSymbolAtLocation(k.moduleReference.expression)===y)return!0;break}}return!1};e:for(let T of C)if(this.token.throwIfCancellationRequested(),F(T)){this.importedByState?.imports(p,this.sourceFile),yield p;break e}else if(u(T)){let k=T.body&&T.body.statements;if(k!==void 0){for(let O of k)if(F(O)){this.importedByState?.imports(p,this.sourceFile),yield p;break e}}}}}}skipSourceFile(a,u){return a.isSourceFileDefaultLibrary(u)||a.isSourceFileFromExternalLibrary(u)||u.isDeclarationFile}*allSourceFiles(){if(this.importedByState===void 0)this.preferredSourceFiles!==void 0&&(yield*this.preferredSourceFiles),yield*this.program.getSourceFiles();else{if(this.preferredSourceFiles!==void 0){for(let a of this.preferredSourceFiles)this.importedByState.isTraversed(a)||(this.importedByState.addTraversed(a),yield a);for(let a of this.program.getSourceFiles())this.importedByState.isTraversed(a)||(this.importedByState.addTraversed(a),yield a)}this.importedByState.markComplete()}}}q.ReferencedByVisitor=Tn;let vn;(m=>{let D=new Map([[i.SyntaxKind.Unknown,0],[i.SyntaxKind.EndOfFileToken,1],[i.SyntaxKind.SingleLineCommentTrivia,2],[i.SyntaxKind.MultiLineCommentTrivia,3],[i.SyntaxKind.NewLineTrivia,4],[i.SyntaxKind.WhitespaceTrivia,5],[i.SyntaxKind.ShebangTrivia,6],[i.SyntaxKind.ConflictMarkerTrivia,7],[i.SyntaxKind.NonTextFileMarkerTrivia,8],[i.SyntaxKind.NumericLiteral,9],[i.SyntaxKind.BigIntLiteral,10],[i.SyntaxKind.StringLiteral,11],[i.SyntaxKind.JsxText,12],[i.SyntaxKind.JsxTextAllWhiteSpaces,13],[i.SyntaxKind.RegularExpressionLiteral,14],[i.SyntaxKind.NoSubstitutionTemplateLiteral,15],[i.SyntaxKind.TemplateHead,16],[i.SyntaxKind.TemplateMiddle,17],[i.SyntaxKind.TemplateTail,18],[i.SyntaxKind.OpenBraceToken,19],[i.SyntaxKind.CloseBraceToken,20],[i.SyntaxKind.OpenParenToken,21],[i.SyntaxKind.CloseParenToken,22],[i.SyntaxKind.OpenBracketToken,23],[i.SyntaxKind.CloseBracketToken,24],[i.SyntaxKind.DotToken,25],[i.SyntaxKind.DotDotDotToken,26],[i.SyntaxKind.SemicolonToken,27],[i.SyntaxKind.CommaToken,28],[i.SyntaxKind.QuestionDotToken,29],[i.SyntaxKind.LessThanToken,30],[i.SyntaxKind.LessThanSlashToken,31],[i.SyntaxKind.GreaterThanToken,32],[i.SyntaxKind.LessThanEqualsToken,33],[i.SyntaxKind.GreaterThanEqualsToken,34],[i.SyntaxKind.EqualsEqualsToken,35],[i.SyntaxKind.ExclamationEqualsToken,36],[i.SyntaxKind.EqualsEqualsEqualsToken,37],[i.SyntaxKind.ExclamationEqualsEqualsToken,38],[i.SyntaxKind.EqualsGreaterThanToken,39],[i.SyntaxKind.PlusToken,40],[i.SyntaxKind.MinusToken,41],[i.SyntaxKind.AsteriskToken,42],[i.SyntaxKind.AsteriskAsteriskToken,43],[i.SyntaxKind.SlashToken,44],[i.SyntaxKind.PercentToken,45],[i.SyntaxKind.PlusPlusToken,46],[i.SyntaxKind.MinusMinusToken,47],[i.SyntaxKind.LessThanLessThanToken,48],[i.SyntaxKind.GreaterThanGreaterThanToken,49],[i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken,50],[i.SyntaxKind.AmpersandToken,51],[i.SyntaxKind.BarToken,52],[i.SyntaxKind.CaretToken,53],[i.SyntaxKind.ExclamationToken,54],[i.SyntaxKind.TildeToken,55],[i.SyntaxKind.AmpersandAmpersandToken,56],[i.SyntaxKind.BarBarToken,57],[i.SyntaxKind.QuestionToken,58],[i.SyntaxKind.ColonToken,59],[i.SyntaxKind.AtToken,60],[i.SyntaxKind.QuestionQuestionToken,61],[i.SyntaxKind.BacktickToken,62],[i.SyntaxKind.HashToken,63],[i.SyntaxKind.EqualsToken,64],[i.SyntaxKind.PlusEqualsToken,65],[i.SyntaxKind.MinusEqualsToken,66],[i.SyntaxKind.AsteriskEqualsToken,67],[i.SyntaxKind.AsteriskAsteriskEqualsToken,68],[i.SyntaxKind.SlashEqualsToken,69],[i.SyntaxKind.PercentEqualsToken,70],[i.SyntaxKind.LessThanLessThanEqualsToken,71],[i.SyntaxKind.GreaterThanGreaterThanEqualsToken,72],[i.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,73],[i.SyntaxKind.AmpersandEqualsToken,74],[i.SyntaxKind.BarEqualsToken,75],[i.SyntaxKind.BarBarEqualsToken,76],[i.SyntaxKind.AmpersandAmpersandEqualsToken,77],[i.SyntaxKind.QuestionQuestionEqualsToken,78],[i.SyntaxKind.CaretEqualsToken,79],[i.SyntaxKind.Identifier,80],[i.SyntaxKind.PrivateIdentifier,81],[i.SyntaxKind.BreakKeyword,83],[i.SyntaxKind.CaseKeyword,84],[i.SyntaxKind.CatchKeyword,85],[i.SyntaxKind.ClassKeyword,86],[i.SyntaxKind.ConstKeyword,87],[i.SyntaxKind.ContinueKeyword,88],[i.SyntaxKind.DebuggerKeyword,89],[i.SyntaxKind.DefaultKeyword,90],[i.SyntaxKind.DeleteKeyword,91],[i.SyntaxKind.DoKeyword,92],[i.SyntaxKind.ElseKeyword,93],[i.SyntaxKind.EnumKeyword,94],[i.SyntaxKind.ExportKeyword,95],[i.SyntaxKind.ExtendsKeyword,96],[i.SyntaxKind.FalseKeyword,97],[i.SyntaxKind.FinallyKeyword,98],[i.SyntaxKind.ForKeyword,99],[i.SyntaxKind.FunctionKeyword,100],[i.SyntaxKind.IfKeyword,101],[i.SyntaxKind.ImportKeyword,102],[i.SyntaxKind.InKeyword,103],[i.SyntaxKind.InstanceOfKeyword,104],[i.SyntaxKind.NewKeyword,105],[i.SyntaxKind.NullKeyword,106],[i.SyntaxKind.ReturnKeyword,107],[i.SyntaxKind.SuperKeyword,108],[i.SyntaxKind.SwitchKeyword,109],[i.SyntaxKind.ThisKeyword,110],[i.SyntaxKind.ThrowKeyword,111],[i.SyntaxKind.TrueKeyword,112],[i.SyntaxKind.TryKeyword,113],[i.SyntaxKind.TypeOfKeyword,114],[i.SyntaxKind.VarKeyword,115],[i.SyntaxKind.VoidKeyword,116],[i.SyntaxKind.WhileKeyword,117],[i.SyntaxKind.WithKeyword,118],[i.SyntaxKind.ImplementsKeyword,119],[i.SyntaxKind.InterfaceKeyword,120],[i.SyntaxKind.LetKeyword,121],[i.SyntaxKind.PackageKeyword,122],[i.SyntaxKind.PrivateKeyword,123],[i.SyntaxKind.ProtectedKeyword,124],[i.SyntaxKind.PublicKeyword,125],[i.SyntaxKind.StaticKeyword,126],[i.SyntaxKind.YieldKeyword,127],[i.SyntaxKind.AbstractKeyword,128],[i.SyntaxKind.AccessorKeyword,129],[i.SyntaxKind.AsKeyword,130],[i.SyntaxKind.AssertsKeyword,131],[i.SyntaxKind.AssertKeyword,132],[i.SyntaxKind.AnyKeyword,133],[i.SyntaxKind.AsyncKeyword,134],[i.SyntaxKind.AwaitKeyword,135],[i.SyntaxKind.BooleanKeyword,136],[i.SyntaxKind.ConstructorKeyword,137],[i.SyntaxKind.DeclareKeyword,138],[i.SyntaxKind.GetKeyword,139],[i.SyntaxKind.InferKeyword,140],[i.SyntaxKind.IntrinsicKeyword,141],[i.SyntaxKind.IsKeyword,142],[i.SyntaxKind.KeyOfKeyword,143],[i.SyntaxKind.ModuleKeyword,144],[i.SyntaxKind.NamespaceKeyword,145],[i.SyntaxKind.NeverKeyword,146],[i.SyntaxKind.OutKeyword,147],[i.SyntaxKind.ReadonlyKeyword,148],[i.SyntaxKind.RequireKeyword,149],[i.SyntaxKind.NumberKeyword,150],[i.SyntaxKind.ObjectKeyword,151],[i.SyntaxKind.SatisfiesKeyword,152],[i.SyntaxKind.SetKeyword,153],[i.SyntaxKind.StringKeyword,154],[i.SyntaxKind.SymbolKeyword,155],[i.SyntaxKind.TypeKeyword,156],[i.SyntaxKind.UndefinedKeyword,157],[i.SyntaxKind.UniqueKeyword,158],[i.SyntaxKind.UnknownKeyword,159],[i.SyntaxKind.UsingKeyword,160],[i.SyntaxKind.FromKeyword,161],[i.SyntaxKind.GlobalKeyword,162],[i.SyntaxKind.BigIntKeyword,163],[i.SyntaxKind.OverrideKeyword,164],[i.SyntaxKind.OfKeyword,165],[i.SyntaxKind.QualifiedName,166],[i.SyntaxKind.ComputedPropertyName,167],[i.SyntaxKind.TypeParameter,168],[i.SyntaxKind.Parameter,169],[i.SyntaxKind.Decorator,170],[i.SyntaxKind.PropertySignature,171],[i.SyntaxKind.PropertyDeclaration,172],[i.SyntaxKind.MethodSignature,173],[i.SyntaxKind.MethodDeclaration,174],[i.SyntaxKind.ClassStaticBlockDeclaration,175],[i.SyntaxKind.Constructor,176],[i.SyntaxKind.GetAccessor,177],[i.SyntaxKind.SetAccessor,178],[i.SyntaxKind.CallSignature,179],[i.SyntaxKind.ConstructSignature,180],[i.SyntaxKind.IndexSignature,181],[i.SyntaxKind.TypePredicate,182],[i.SyntaxKind.TypeReference,183],[i.SyntaxKind.FunctionType,184],[i.SyntaxKind.ConstructorType,185],[i.SyntaxKind.TypeQuery,186],[i.SyntaxKind.TypeLiteral,187],[i.SyntaxKind.ArrayType,188],[i.SyntaxKind.TupleType,189],[i.SyntaxKind.OptionalType,190],[i.SyntaxKind.RestType,191],[i.SyntaxKind.UnionType,192],[i.SyntaxKind.IntersectionType,193],[i.SyntaxKind.ConditionalType,194],[i.SyntaxKind.InferType,195],[i.SyntaxKind.ParenthesizedType,196],[i.SyntaxKind.ThisType,197],[i.SyntaxKind.TypeOperator,198],[i.SyntaxKind.IndexedAccessType,199],[i.SyntaxKind.MappedType,200],[i.SyntaxKind.LiteralType,201],[i.SyntaxKind.NamedTupleMember,202],[i.SyntaxKind.TemplateLiteralType,203],[i.SyntaxKind.TemplateLiteralTypeSpan,204],[i.SyntaxKind.ImportType,205],[i.SyntaxKind.ObjectBindingPattern,206],[i.SyntaxKind.ArrayBindingPattern,207],[i.SyntaxKind.BindingElement,208],[i.SyntaxKind.ArrayLiteralExpression,209],[i.SyntaxKind.ObjectLiteralExpression,210],[i.SyntaxKind.PropertyAccessExpression,211],[i.SyntaxKind.ElementAccessExpression,212],[i.SyntaxKind.CallExpression,213],[i.SyntaxKind.NewExpression,214],[i.SyntaxKind.TaggedTemplateExpression,215],[i.SyntaxKind.TypeAssertionExpression,216],[i.SyntaxKind.ParenthesizedExpression,217],[i.SyntaxKind.FunctionExpression,218],[i.SyntaxKind.ArrowFunction,219],[i.SyntaxKind.DeleteExpression,220],[i.SyntaxKind.TypeOfExpression,221],[i.SyntaxKind.VoidExpression,222],[i.SyntaxKind.AwaitExpression,223],[i.SyntaxKind.PrefixUnaryExpression,224],[i.SyntaxKind.PostfixUnaryExpression,225],[i.SyntaxKind.BinaryExpression,226],[i.SyntaxKind.ConditionalExpression,227],[i.SyntaxKind.TemplateExpression,228],[i.SyntaxKind.YieldExpression,229],[i.SyntaxKind.SpreadElement,230],[i.SyntaxKind.ClassExpression,231],[i.SyntaxKind.OmittedExpression,232],[i.SyntaxKind.ExpressionWithTypeArguments,233],[i.SyntaxKind.AsExpression,234],[i.SyntaxKind.NonNullExpression,235],[i.SyntaxKind.MetaProperty,236],[i.SyntaxKind.SyntheticExpression,237],[i.SyntaxKind.SatisfiesExpression,238],[i.SyntaxKind.TemplateSpan,239],[i.SyntaxKind.SemicolonClassElement,240],[i.SyntaxKind.Block,241],[i.SyntaxKind.EmptyStatement,242],[i.SyntaxKind.VariableStatement,243],[i.SyntaxKind.ExpressionStatement,244],[i.SyntaxKind.IfStatement,245],[i.SyntaxKind.DoStatement,246],[i.SyntaxKind.WhileStatement,247],[i.SyntaxKind.ForStatement,248],[i.SyntaxKind.ForInStatement,249],[i.SyntaxKind.ForOfStatement,250],[i.SyntaxKind.ContinueStatement,251],[i.SyntaxKind.BreakStatement,252],[i.SyntaxKind.ReturnStatement,253],[i.SyntaxKind.WithStatement,254],[i.SyntaxKind.SwitchStatement,255],[i.SyntaxKind.LabeledStatement,256],[i.SyntaxKind.ThrowStatement,257],[i.SyntaxKind.TryStatement,258],[i.SyntaxKind.DebuggerStatement,259],[i.SyntaxKind.VariableDeclaration,260],[i.SyntaxKind.VariableDeclarationList,261],[i.SyntaxKind.FunctionDeclaration,262],[i.SyntaxKind.ClassDeclaration,263],[i.SyntaxKind.InterfaceDeclaration,264],[i.SyntaxKind.TypeAliasDeclaration,265],[i.SyntaxKind.EnumDeclaration,266],[i.SyntaxKind.ModuleDeclaration,267],[i.SyntaxKind.ModuleBlock,268],[i.SyntaxKind.CaseBlock,269],[i.SyntaxKind.NamespaceExportDeclaration,270],[i.SyntaxKind.ImportEqualsDeclaration,271],[i.SyntaxKind.ImportDeclaration,272],[i.SyntaxKind.ImportClause,273],[i.SyntaxKind.NamespaceImport,274],[i.SyntaxKind.NamedImports,275],[i.SyntaxKind.ImportSpecifier,276],[i.SyntaxKind.ExportAssignment,277],[i.SyntaxKind.ExportDeclaration,278],[i.SyntaxKind.NamedExports,279],[i.SyntaxKind.NamespaceExport,280],[i.SyntaxKind.ExportSpecifier,281],[i.SyntaxKind.MissingDeclaration,282],[i.SyntaxKind.ExternalModuleReference,283],[i.SyntaxKind.JsxElement,284],[i.SyntaxKind.JsxSelfClosingElement,285],[i.SyntaxKind.JsxOpeningElement,286],[i.SyntaxKind.JsxClosingElement,287],[i.SyntaxKind.JsxFragment,288],[i.SyntaxKind.JsxOpeningFragment,289],[i.SyntaxKind.JsxClosingFragment,290],[i.SyntaxKind.JsxAttribute,291],[i.SyntaxKind.JsxAttributes,292],[i.SyntaxKind.JsxSpreadAttribute,293],[i.SyntaxKind.JsxExpression,294],[i.SyntaxKind.JsxNamespacedName,295],[i.SyntaxKind.CaseClause,296],[i.SyntaxKind.DefaultClause,297],[i.SyntaxKind.HeritageClause,298],[i.SyntaxKind.CatchClause,299],[i.SyntaxKind.ImportAttributes,300],[i.SyntaxKind.ImportAttribute,301],[i.SyntaxKind.PropertyAssignment,303],[i.SyntaxKind.ShorthandPropertyAssignment,304],[i.SyntaxKind.SpreadAssignment,305],[i.SyntaxKind.EnumMember,306],[i.SyntaxKind.SourceFile,307],[i.SyntaxKind.Bundle,308],[i.SyntaxKind.JSDocTypeExpression,309],[i.SyntaxKind.JSDocNameReference,310],[i.SyntaxKind.JSDocMemberName,311],[i.SyntaxKind.JSDocAllType,312],[i.SyntaxKind.JSDocUnknownType,313],[i.SyntaxKind.JSDocNullableType,314],[i.SyntaxKind.JSDocNonNullableType,315],[i.SyntaxKind.JSDocOptionalType,316],[i.SyntaxKind.JSDocFunctionType,317],[i.SyntaxKind.JSDocVariadicType,318],[i.SyntaxKind.JSDocNamepathType,319],[i.SyntaxKind.JSDoc,320],[i.SyntaxKind.JSDocText,321],[i.SyntaxKind.JSDocTypeLiteral,322],[i.SyntaxKind.JSDocSignature,323],[i.SyntaxKind.JSDocLink,324],[i.SyntaxKind.JSDocLinkCode,325],[i.SyntaxKind.JSDocLinkPlain,326],[i.SyntaxKind.JSDocTag,327],[i.SyntaxKind.JSDocAugmentsTag,328],[i.SyntaxKind.JSDocImplementsTag,329],[i.SyntaxKind.JSDocAuthorTag,330],[i.SyntaxKind.JSDocDeprecatedTag,331],[i.SyntaxKind.JSDocClassTag,332],[i.SyntaxKind.JSDocPublicTag,333],[i.SyntaxKind.JSDocPrivateTag,334],[i.SyntaxKind.JSDocProtectedTag,335],[i.SyntaxKind.JSDocReadonlyTag,336],[i.SyntaxKind.JSDocOverrideTag,337],[i.SyntaxKind.JSDocCallbackTag,338],[i.SyntaxKind.JSDocOverloadTag,339],[i.SyntaxKind.JSDocEnumTag,340],[i.SyntaxKind.JSDocParameterTag,341],[i.SyntaxKind.JSDocReturnTag,342],[i.SyntaxKind.JSDocThisTag,343],[i.SyntaxKind.JSDocTypeTag,344],[i.SyntaxKind.JSDocTemplateTag,345],[i.SyntaxKind.JSDocTypedefTag,346],[i.SyntaxKind.JSDocSeeTag,347],[i.SyntaxKind.JSDocPropertyTag,348],[i.SyntaxKind.JSDocThrowsTag,349],[i.SyntaxKind.JSDocSatisfiesTag,350],[i.SyntaxKind.JSDocImportTag,351],[i.SyntaxKind.SyntaxList,352],[i.SyntaxKind.NotEmittedStatement,353],[i.SyntaxKind.PartiallyEmittedExpression,354],[i.SyntaxKind.CommaListExpression,355],[i.SyntaxKind.SyntheticReferenceExpression,356],[i.SyntaxKind.NotEmittedTypeElement,357]]),a=9999;function u(h){let y=[];for(;h!==void 0;)y.push(D.get(h.kind)??a),h=h.parent;return y}m.getPath=u})(vn=q.StableSyntaxKinds||={})})(Wt||={});Qt.exports=Wt});var An,Ln,ce,Q,Se,yt,ht,St,Yt,En,be,Mn,Bn,Z=V(()=>{"use strict";(e=>{function d(t){return t.cache!==void 0}e.has=d})(An||={});(e=>{function d(t,n){return{key:t,sizeInChars:n}}e.create=d})(Ln||={});(e=>{function d(t){return{kind:"reference",key:t}}e.create=d})(ce||={});(n=>{function d(r,o,s){return{kind:"trait",key:t(r),name:o,value:s}}n.create=d;function e(r){return r.name.length+r.value.length}n.sizeInChars=e;function t(r){return JSON.stringify({k:"trait",tk:r},void 0,0)}n.createContextItemKey=t})(Q||={});(t=>{function d(n,r,o,s){return{kind:"snippet",key:n,fileName:r,additionalFileNames:o,value:s}}t.create=d;function e(n){let r=n.value.length;if(r+=n.fileName.length+3,n.additionalFileNames!==void 0)for(let o of n.additionalFileNames)r+=o.length+3;return r}t.sizeInChars=e})(Se||={});(t=>{function d(n){return n.key!==void 0}t.hasKey=d;function e(n){switch(n.kind){case"trait":return Q.sizeInChars(n);case"snippet":return Se.sizeInChars(n);default:return 0}}t.sizeInChars=e})(yt||={});(e=>{function d(t,n){return{code:t,message:n}}e.create=d})(ht||={});(e=>{function d(t,n){return{totalTime:t,computeTime:n}}e.create=d})(St||={});(e=>{function d(t){return t.type==="response"&&t.body.error!==void 0}e.isError=d})(Yt||={});(n=>{function d(r){return r.type==="cancelled"}n.isCancelled=d;function e(r){return r.type==="response"&&r.body.state!==void 0}n.isOk=e;function t(r){return r.type==="cancelled"?!1:Yt.isError(r)}n.isError=t})(En||={});be=(n=>(n.no="no",n.yes="yes",n.maybe="maybe",n))(be||{});(e=>{function d(t){switch(t){case"no":return"no";case"yes":return"yes";case"maybe":return"maybe";default:return"no"}}e.fromString=d})(be||={});(n=>{function d(r){return r.type==="cancelled"}n.isCancelled=d;function e(r){return r.type==="response"&&r.body.canRename!==void 0}n.isOk=e;function t(r){return r.type==="response"&&r.body.error!==void 0}n.isError=t})(Mn||={});(n=>{function d(r){return r.type==="cancelled"}n.isCancelled=d;function e(r){return r.type==="response"&&r.body.groups!==void 0}n.isOk=e;function t(r){return r.type==="response"&&r.body.error!==void 0}n.isError=t})(Bn||={})});var ge,N,Fe=V(()=>{"use strict";ge=class{getSymbolInfo(e){let t=e.declarations;if(t===void 0||t.length===0)return{skip:!0};let n,r=0,o=this.getProgram();for(let s of t){let l=s.getSourceFile();n===void 0&&(n=l),(o.isSourceFileDefaultLibrary(l)||o.isSourceFileFromExternalLibrary(l))&&r++}return r>0?{skip:!0}:{skip:!1,primary:n}}skipDeclaration(e,t=e.getSourceFile()){let n=this.getProgram();return n.isSourceFileDefaultLibrary(t)||n.isSourceFileFromExternalLibrary(t)}},N=class extends Error{static SourceFileNotFound=1;static NodeNotFound=2;static NodeKindMismatch=3;static SymbolNotFound=4;static NoDeclaration=5;static NoProgram=6;static NoSourceFile=7;code;constructor(e,t){super(e),this.code=t}}});var P,_,ke,xe,Pe,bt,gt,xt,Ct,Rt,Tt,U,De=V(()=>{"use strict";z();Z();Fe();P=ie(re()),_=A();(r=>{function d(o,s,l){l??=o.getSourceFile();let c=o.getStart(l,s),f=l.getLineAndCharacterOfPosition(c),b=l.text.substring(c,o.getEnd()).split(/\r?\n/g);if(f.character>0){let x=l.getPositionOfLineAndCharacter(f.line,0),R=l.text.substring(x,c);t(b,R)}return n(b),b}r.getLines=d;function e(o){let s=o.getFullText(),l=_.getLeadingCommentRanges(s,0);if(l!==void 0&&l.length>0){let c=l.at(-1).pos,f=l.at(-1).end,b=s.substring(c,f).trim().split(/\r?\n/);if(n(b),b.length>1){let R=b[1].match(/^\s+/);R!==null&&t(b,R[0])}return b}}r.getDocumentation=e;function t(o,s,l=1){let c=!0;for(let f=l;f<o.length;f++)if(!o[f].startsWith(s)){c=!1;break}if(c)for(let f=l;f<o.length;f++)o[f]=o[f].substring(s.length)}function n(o){for(;o.length>0&&o[0].trim()==="";)o.shift();for(;o.length>0&&o.at(-1).trim()==="";)o.pop()}})(ke||={});xe=class{context;indent;lines;source;additionalSources;constructor(e,t,n=0){this.context=e,this.indent=n,this.source=t.fileName,this.lines=[],this.additionalSources=new Set}makeKey(e){if(Array.isArray(e)){if(e.length===0)return;let t=[];for(let n of e){let r=P.Symbols.createVersionedKey(n,this.context.session);if(r!==void 0)t.push(r);else{t=void 0;break}}return t===void 0?void 0:t.join(";")}else return P.Symbols.createVersionedKey(e,this.context.session)}getLines(){return this.lines}getAdditionalSources(){return this.additionalSources.delete(this.source),this.additionalSources}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}addLine(e){this.indent===0?this.lines.push(e):this.lines.push("	".repeat(this.indent)+e)}addLines(e){for(let t of e)this.addLine(t)}addConstructorDeclaration(e){this.addDocumentation(e);let t=[];e.modifiers!==void 0&&(t.push(e.modifiers.map(n=>n.getText()).join(" ")),t.push(" ")),t.push("constructor"),t.push("("),t.push(this.getParameters(e.parameters)),t.push(");"),this.addLine(t.join(""))}addPropertyDeclaration(e){this.addLines(ke.getLines(e,this.context.includeDocumentation))}addMethodDeclaration(e){this.addDocumentation(e);let t=[];e.modifiers!==void 0&&(t.push(e.modifiers.map(n=>n.getText()).join(" ")),t.push(" ")),t.push(e.name.getText()),e.typeParameters!==void 0&&(t.push("<"),t.push(e.typeParameters.map(n=>n.getText()).join(", ")),t.push(">")),t.push("("),e.parameters!==void 0&&t.push(e.parameters.map(n=>n.getText()).join(", ")),t.push(")"),e.type!==void 0&&(t.push(": "),t.push(e.type.getText())),t.push(";"),this.addLine(t.join(""))}addCallSignatureDeclaration(e){this.addDocumentation(e);let t=[];e.typeParameters!==void 0&&(t.push("<"),t.push(e.typeParameters.map(n=>n.getText()).join(", ")),t.push(">")),t.push("("),e.parameters!==void 0&&t.push(e.parameters.map(n=>n.getText()).join(", ")),t.push(")"),e.type!==void 0&&(t.push(": "),t.push(e.type.getText())),t.push(";"),this.addLine(t.join(""))}addGetAccessorDeclaration(e){this.addAccessorDeclaration(e,"get")}addSetAccessorDeclaration(e){this.addAccessorDeclaration(e,"set")}addAccessorDeclaration(e,t){this.addDocumentation(e);let n=[];e.modifiers!==void 0&&(n.push(e.modifiers.map(r=>r.getText()).join(" ")),n.push(" ")),n.push(`${t} `),n.push(e.name.getText()),e.type!==void 0&&(n.push(": "),n.push(e.type.getText())),n.push(";"),this.addLine(n.join(""))}addFunctionDeclaration(e,t,n){t??=e.name?.getText()??"",this.addDocumentation(e);let r=[];r.push(this.getModifiers(e.modifiers,n)),r.push(" function "),r.push(t),r.push(this.getTypeParameters(e.typeParameters)),r.push("("),r.push(this.getParameters(e.parameters)),r.push(")"),r.push(this.getReturnTypes(e)),r.push(";"),this.addLine(r.join(""))}addDocumentation(e){if(!this.context.includeDocumentation)return;let t=ke.getDocumentation(e);t!==void 0&&this.addLines(t)}getModifiers(e,t){if(e===void 0)return"";let n=[];t!==void 0&&n.push(t);for(let r of e)r.kind===_.SyntaxKind.AsyncKeyword||r.kind===_.SyntaxKind.DeclareKeyword||r.kind===_.SyntaxKind.ExportKeyword||n.push(r.getText());return n.join(" ")}getTypeParameters(e){if(e===void 0)return"";let t=[];return t.push("<"),t.push(e.map(n=>n.getText()).join(", ")),t.push(">"),t.join("")}getParameters(e){return e===void 0?"":e.map(t=>t.getText()).join(", ")}getReturnTypes(e){return e.type===void 0?"":`: ${e.type.getText()}`}},Pe=class extends xe{type;name;seen;constructor(e,t,n,r){super(e,t),this.type=n,this.name=r,this.seen=new Set}processMembers(e){for(let[t,n]of e)this.seen.has(t)||(this.seen.add(t),this.processMember(n))}processMember(e){let t=e.declarations;if(t!==void 0){if(P.Symbols.isProperty(e)){let n=t[0];(_.isPropertyDeclaration(n)||_.isPropertySignature(n))&&this.addPropertyDeclaration(n)}else if(P.Symbols.isMethod(e))for(let n of t)(_.isMethodDeclaration(n)||_.isMethodSignature(n))&&this.addMethodDeclaration(n);else if(P.Symbols.isSetAccessor(e)||P.Symbols.isGetAccessor(e))for(let n of t)_.isGetAccessorDeclaration(n)?this.addGetAccessorDeclaration(n):_.isSetAccessorDeclaration(n)&&this.addSetAccessorDeclaration(n);else if(P.Symbols.isSignature(e))for(let n of t)_.isCallSignatureDeclaration(n)&&this.addCallSignatureDeclaration(n);else if(P.Symbols.isConstructor(e))for(let n of t)_.isConstructorDeclaration(n)&&this.addConstructorDeclaration(n)}}getTypeParameters(){let e=this.type.declarations;if(e===void 0||e.length===0)return"";let t=e[0];return(_.isClassDeclaration(t)||_.isInterfaceDeclaration(t)||_.isTypeAliasDeclaration(t))&&t.typeParameters!==void 0?super.getTypeParameters(t.typeParameters):""}},bt=class extends Pe{superClasses;includePrivates;key;constructor(e,t,n,r,o,s,l){super(e,n,r,o),this.includePrivates=l,this.key=void 0,s?(this.superClasses=new Array(...t.getAllSuperClasses(r)),this.key=this.makeKey([r,...this.superClasses])):(this.key=this.makeKey(r),this.superClasses=void 0)}emit(){if(this.addLine(`declare class ${this.name}${this.getTypeParameters()} {`),this.increaseIndent(),this.type.members!==void 0&&(P.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.superClasses!==void 0)for(let e=this.superClasses.length-1;e>=0;e--){let t=this.superClasses[e];t.members!==void 0&&(P.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.decreaseIndent(),this.addLine("}")}processMember(e){!this.includePrivates&&P.Symbols.isPrivate(e)||super.processMember(e)}},gt=class extends Pe{superTypes;key;constructor(e,t,n,r,o){super(e,n,r,o),this.superTypes=new Array(...t.getAllSuperTypes(r)).filter(s=>P.Symbols.isInterface(s)),this.superTypes.length===0?this.key=this.makeKey(r):this.key=this.makeKey([r,...this.superTypes])}emit(){this.addLine(`interface ${this.name}${this.getTypeParameters()} {`),this.increaseIndent(),this.type.members!==void 0&&(P.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members));for(let e=this.superTypes.length-1;e>=0;e--){let t=this.superTypes[e];t.members!==void 0&&(P.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.decreaseIndent(),this.addLine("}")}},xt=class extends xe{type;name;key;constructor(e,t,n,r){super(e,t),this.type=n,this.name=r,this.key=this.makeKey(n)}emit(){if(this.addLine(`${P.Symbols.isConstEnum(this.type)?"const ":""}enum ${this.name} {`),this.increaseIndent(),this.type.exports!==void 0){let e=0,t=this.type.exports.size-1;for(let[n,r]of this.type.exports){let o=r.declarations;if(o===void 0)continue;let s=o[0];if(_.isEnumMember(s)){let l=ke.getLines(s,this.context.includeDocumentation);e<t&&(l[l.length-1]+=","),this.addLines(l)}e++}}this.decreaseIndent(),this.addLine("}")}},Ct=class extends Pe{key;constructor(e,t,n,r){super(e,t,n,r)}emit(){this.addLine(`type ${this.name} = {`),this.increaseIndent(),this.type.members!==void 0&&this.processMembers(this.type.members),this.decreaseIndent(),this.addLine("}")}},Rt=class extends xe{func;name;constructor(e,t,n,r){super(e,t),this.func=n,this.name=r??n.getName()}get key(){}emit(e){let t=this.func.declarations;if(t!==void 0)for(let n of t){let r=n.getSourceFile().fileName;r!==e.fileName&&_.isFunctionDeclaration(n)&&(this.addFunctionDeclaration(n,this.name,"declare"),this.additionalSources.add(r))}}},Tt=class extends xe{module;name;constructor(e,t,n,r){super(e,t),this.module=n,this.name=r??n.getName()}get key(){}emit(e){this.addLine(`declare namespace ${this.name} {`),this.increaseIndent();let t=this.module.exports;t!==void 0&&this.addExports(t,e),this.decreaseIndent(),this.addLine("}")}addExports(e,t){for(let[n,r]of e){let o=r.declarations;if(o!==void 0&&P.Symbols.isFunction(r))for(let s of o){let l=s.getSourceFile().fileName;l!==t.fileName&&_.isFunctionDeclaration(s)&&(this.addFunctionDeclaration(s,void 0,"declare"),this.additionalSources.add(l))}}}},U=class extends ge{lines;source;additionalSources;indent=0;context;symbols;currentSourceFile;constructor(e,t,n){super(),this.lines=[],this.source=void 0,this.additionalSources=new Set,this.context=e,this.symbols=t,this.currentSourceFile=n}getSymbolInfo(e){let t=super.getSymbolInfo(e);return t.skip===!1&&t.primary.fileName===this.currentSourceFile.fileName?{skip:!0}:t}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}getProgram(){return this.symbols.getProgram()}addSource(e){this.source===void 0?this.source=e:this.additionalSources.add(e)}addAdditionalSource(e){if(e!==void 0)for(let t of e)this.additionalSources.add(t)}isEmpty(){return this.lines.length===0||this.source===void 0}snippet(e){if(this.source===void 0)throw new N("No source",N.NoSourceFile);return this.additionalSources.delete(this.source),Se.create(e,this.source,this.additionalSources.size===0?void 0:[...this.additionalSources],this.lines.join(`
`))}addDeclaration(e){let t=e.getSourceFile();t.fileName===this.currentSourceFile.fileName||this.skipDeclaration(e,t)||(this.addLines(ke.getLines(e,this.context.includeDocumentation,t)),this.addSource(t.fileName))}addLines(e){e.length!==0&&(this.indent===0?this.lines.push(...e):this.lines.push(...e.map(t=>`${"	".repeat(this.indent)}${t}`)))}addClassSymbol(e,t,n=!0,r=!1){if(!P.Symbols.isClass(e))return;let o=this.getSymbolInfo(e);o.skip||this.addEmitter(new bt(this.context,this.symbols,o.primary,e,t,n,r))}addTypeLiteralSymbol(e,t){if(!P.Symbols.isTypeLiteral(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new Ct(this.context,n.primary,e,t))}addInterfaceSymbol(e,t){if(!P.Symbols.isInterface(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new gt(this.context,this.symbols,n.primary,e,t))}addTypeAliasSymbol(e,t){P.Symbols.isTypeAlias(e)}addEnumSymbol(e,t){if(!P.Symbols.isEnum(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new xt(this.context,n.primary,e,t))}addFunctionSymbol(e,t){if(!P.Symbols.isFunction(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new Rt(this.context,n.primary,e,t))}addModuleSymbol(e,t){if(!P.Symbols.isValueModule(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new Tt(this.context,n.primary,e,t))}addTypeSymbol(e,t){if(t===void 0&&P.Symbols.isInternal(e))return;let n=t??e.getName();P.Symbols.isClass(e)?this.addClassSymbol(e,n):P.Symbols.isInterface(e)?this.addInterfaceSymbol(e,n):P.Symbols.isTypeAlias(e)?this.addTypeAliasSymbol(e,n):P.Symbols.isEnum(e)?this.addEnumSymbol(e,n):P.Symbols.isFunction(e)?this.addFunctionSymbol(e,n):P.Symbols.isValueModule(e)?this.addModuleSymbol(e,n):P.Symbols.isTypeLiteral(e)&&n!==void 0&&this.addTypeLiteralSymbol(e,n)}addEmitter(e){let t,n,r,o=this.context.session;if(e.key!==void 0){let s=o.getCachedCode(e.key);s!==void 0&&(t=s.value,n=s.uri,r=s.additionalUris)}(t===void 0||n===void 0)&&(e.emit(this.currentSourceFile),t=e.getLines(),n=e.source,r=e.getAdditionalSources(),e.key!==void 0&&o.cacheCode(e.key,{value:t,uri:n,additionalUris:r})),this.indent===0?this.lines.push(...t):this.lines.push(...t.map(s=>`${"	".repeat(this.indent)}${s}`)),this.addSource(n),this.addAdditionalSource(r)}}});var vt,It,Ve,Xt=V(()=>{"use strict";vt=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let r=this._map.get(e);if(r)r.value=t,n!==0&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(r);break;case 1:this.addItemFirst(r);break;case 2:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return r}values(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return r}entries(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return r}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(n.previous=r,r.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,r=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=r,r.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},It=class extends vt{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Ve=class extends It{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}});var B,J,He,G,je,Je,Ge,Kt,ze,oe,Ft,H,Ue,Y,we,Ne,ue=V(()=>{"use strict";z();De();Z();Fe();B=ie(re());Xt();J=A(),He=class{symbols;neighborFiles;clientSideRunnableResults;clientSideContextItems;session;includeDocumentation;constructor(e,t,n,r){this.session=e,this.symbols=new Map,this.neighborFiles=t,this.clientSideRunnableResults=n,this.clientSideContextItems=new Map;for(let o of n.values())for(let s of o.items)this.clientSideContextItems.set(s.key,s);this.includeDocumentation=r}getSymbols(e){let t=this.symbols.get(e);return t===void 0&&(t=new B.Symbols(e),this.symbols.set(e,t)),t}getPreferredNeighborFiles(e){let t=[];for(let n of this.neighborFiles){let r=e.getSourceFile(n);r!==void 0&&t.push(r)}return t}createContextItemReferenceIfManaged(e){let t=this.clientSideContextItems.get(e);return t!==void 0?ce.create(t.key):void 0}clientHasContextItem(e){return this.clientSideContextItems.has(e)}},G=class extends ge{program;symbols;constructor(e,t=new B.Symbols(e)){if(super(),e!==t.getProgram())throw new Error("Program and symbols program must match");this.program=e,this.symbols=t}getSymbols(){return this.symbols}getProgram(){return this.program}getHeritageSymbol(e){let t=this.symbols.getLeafSymbolAtLocation(e);if(t===void 0)return;B.Symbols.isAlias(t)&&(t=this.symbols.getLeafSymbol(t));let n=0;for(;B.Symbols.isTypeAlias(t)&&n<10;){let r=t.declarations;if(r!==void 0){let o=t;for(let s of r)if(J.isTypeAliasDeclaration(s)){let l=s.type;J.isTypeReferenceNode(l)&&(t=this.symbols.getLeafSymbolAtLocation(l.typeName))}if(o===t)break}n++}return t}static getNodeInProgram(e,t){function n(c,f){if(c===void 0||f===void 0)return c===f;for(;c!==void 0&&f!==void 0;){if(c.kind!==f.kind||c.pos!==f.pos||c.end!==f.end)return!1;c=c.parent,f=f.parent}return c===void 0&&f===void 0}let r=t.getSourceFile().fileName,o=e.getSourceFile(r);if(o===void 0)throw new N(`No source file found for ${r}`,N.SourceFileNotFound);let s=B.default.getTokenAtPosition(o,t.pos),l=s;if(l===void 0)throw new N(`No node found for ${r}:${t.pos}`,N.NodeNotFound);for(;l!==void 0;){if(t.pos===l.pos&&t.end===l.end&&t.kind===l.kind&&n(t.parent,l.parent))return l;l=l.parent}throw new N(`Found node ${s.kind} for node ${t.kind} in file ${r}:${t.pos}`,N.NodeKindMismatch)}},je=class{info(){}msg(){}startGroup(){}endGroup(){}},Je=class{languageServiceHost;host;codeCache;importedByState;supportsCaching;constructor(e,t,n){this.languageServiceHost=e,this.host=t,this.codeCache=new Ve(100),this.importedByState=new Map,this.supportsCaching=n}getImportedByState(e){let t=this.importedByState.get(e);return t===void 0&&(t=new B.ImportedByState(e),this.importedByState.set(e,t)),t}run(e,t,n){let r=this.getPossiblePrograms(e,t);for(let o of r){let l=e.with(o).run(t,n);if(l!==void 0)return[o,l]}return[void 0,void 0]}getPossiblePrograms(e,t){let n=[];for(let r of this.getLanguageServices()){let o=r.getProgram();if(o===void 0)continue;let s=e.score(o,t);s>0&&n.push([s,o])}return n.sort((r,o)=>o[0]-r[0]).map(r=>r[1])}getCachedCode(e,t){if(this.supportsCaching){if(typeof e=="string")return this.codeCache.get(e);{let n=B.Symbols.createVersionedKey(t,this);return n===void 0?void 0:this.codeCache.get(n)}}}cacheCode(e,t){if(this.supportsCaching)if(typeof e=="string")this.codeCache.set(e,t);else{let n=B.Symbols.createVersionedKey(e,this);n!==void 0&&this.codeCache.set(n,t)}}enableBlueprintSearch(){return!1}},Ge=class{id;runnableResultContext;primaryBudget;secondaryBudget;state;speculativeKind;cache;priority;items;debugPath;constructor(e,t,n,r,o,s,l){this.id=e,this.priority=t,this.runnableResultContext=n,this.primaryBudget=r,this.secondaryBudget=o,this.state="created",this.speculativeKind=s,this.cache=l,this.items=[]}isPrimaryBudgetExhausted(){return this.primaryBudget.isExhausted()?(this.state="isFull",!0):!1}isSecondaryBudgetExhausted(){return this.secondaryBudget.isExhausted()}done(){(this.state==="created"||this.state==="inProgress")&&(this.state="finished")}setCacheInfo(e){this.cache=e}addFromKnownItems(e){this.state="inProgress";let t=this.runnableResultContext.createContextItemReference(e);return t===void 0?!1:(this.items.push(t),!0)}addTrait(e,t,n){this.state="inProgress";let r=Q.create(e,t,n);this.items.push(this.runnableResultContext.manageContextItem(r)),this.primaryBudget.spent(Q.sizeInChars(r))}addSnippet(e,t,n,r=!1){let o=t===0?this.primaryBudget:this.secondaryBudget;if(e.isEmpty())return!0;let s=e.snippet(n),l=Se.sizeInChars(s);return r&&!o.hasRoom(l)?(this.state="isFull",!1):(this.state="inProgress",o.spent(l),this.items.push(this.runnableResultContext.manageContextItem(s)),!0)}toJson(){return{kind:"computedResult",id:this.id,state:this.state,priority:this.priority,items:this.items,cache:this.cache,speculativeKind:this.speculativeKind,debugPath:this.debugPath}}},Kt=class{cached;constructor(e){this.cached=e}get items(){let e=[];for(let t of this.cached.items)e.push(ce.create(t.key));return e}toJson(){return{kind:"reference",id:this.cached.id}}},ze=class{primaryBudget;secondaryBudget;context;state;path;timings;timedOut;errors;runnableResults=[];contextItems;constructor(e,t,n){this.primaryBudget=e,this.secondaryBudget=t,this.context=n,this.state="created",this.path=void 0,this.timedOut=!1,this.errors=[],this.runnableResults=[],this.contextItems=new Map}getSession(){return this.context.session}addPath(e){this.path=e}addErrorData(e){this.errors.push(ht.create(e.code,e.message))}addTimings(e,t){this.timings=St.create(e,t)}setTimedOut(e){this.timedOut=e}createRunnableResult(e,t,n,r){this.state="inProgress";let o=new Ge(e,t,this,this.primaryBudget,this.secondaryBudget,n,r);return this.runnableResults.push(o),o}addRunnableResultReference(e){this.state="inProgress",this.runnableResults.push(new Kt(e))}createContextItemReference(e){let t=this.context.createContextItemReferenceIfManaged(e);if(t!==void 0)return t;if(this.contextItems.get(e)!==void 0)return ce.create(e)}manageContextItem(e){if(!yt.hasKey(e))return e;let t=e.key;return this.context.clientHasContextItem(t)?ce.create(t):this.contextItems.has(t)?ce.create(t):(this.contextItems.set(t,e),ce.create(t))}done(){this.state="finished"}items(){let e=new Set,t=[],n=this.runnableResults.slice().filter(r=>r instanceof Ge).sort((r,o)=>r.priority<o.priority?1:r.priority>o.priority?-1:0);for(let r of n)for(let o of r.items)if(o.kind==="reference"){if(e.has(o.key))continue;e.add(o.key);let s=this.contextItems.get(o.key);if(s!==void 0){let l=Object.assign({},s,{priority:r.priority});t.push(l)}}else{let s=Object.assign({},o,{priority:r.priority});t.push(s)}return t}toJson(){let e=[];for(let t of this.runnableResults)e.push(t.toJson());return{state:this.state,path:this.path,timings:this.timings,errors:this.errors,timedOut:this.timedOut,exhausted:this.primaryBudget.isExhausted(),runnableResults:e,contextItems:Array.from(this.contextItems.values())}}};(o=>{function d(s){let l=s.body;if(!(l===void 0||!J.isBlock(l)))return e(l,s.getSourceFile())}o.fromDeclaration=d;function e(s,l){return r(s)?{kind:"withinRange",range:n(s,l)}:{kind:"withinRange",range:n(s,l)}}o.createWithinCacheScope=e;function t(s,l){let c=[];for(let f of s)c.push(n(f,l));return c.sort((f,S)=>f.start.line!==S.start.line?f.start.line-S.start.line:f.start.character-S.start.character),{kind:"outsideRange",ranges:c}}o.createOutsideCacheScope=t;function n(s,l){let c,f;r(s)?(c=s.pos,f=s.end):(c=s.getStart(l),f=s.getEnd(),l===void 0&&(l=s.getSourceFile()));let S=J.getLineAndCharacterOfPosition(l,c),b=J.getLineAndCharacterOfPosition(l,f);return{start:S,end:b}}o.createRange=n;function r(s){return Array.isArray(s)}})(oe||={});Ft=class{cached;tokenBudget;id;priority;cost;constructor(e,t,n){this.cached=e,this.id=e.id,this.priority=t,this.cost=n}initialize(e){this.tokenBudget=e.primaryBudget,e.addRunnableResultReference(this.cached)}compute(){if(this.tokenBudget!==void 0)for(let e of this.cached.items)this.tokenBudget.spent(e.sizeInChars??0)}},H=class{session;symbols;id;location;priority;cost;languageService;context;program;result;constructor(e,t,n,r,o,s,l){this.session=e,this.languageService=t,this.program=t.getProgram(),this.context=n,this.symbols=n.getSymbols(this.getProgram()),this.id=r,this.location=o,this.priority=s,this.cost=l}initialize(e){if(this.result!==void 0)throw new Error("Runnable already initialized");this.result=this.createRunnableResult(e)}useCachedResult(e){let t=e.cache;if(t===void 0)return!1;if(t.emitMode==="clientBased"){if(e.state==="finished")return!0;if(e.state==="isFull"){let n=e.cache?.scope.kind;if(n==="withinRange"||n==="neighborFiles"||n==="file")return!0}}return!1}compute(e){if(this.result===void 0)throw new Error("Runnable not initialized");e.throwIfCancellationRequested(),!this.result.isPrimaryBudgetExhausted()&&(this.run(this.result,e),this.result.done())}getProgram(){if(this.program===void 0)throw new N("No program available",N.NoProgram);return this.program}createCacheScope(e,t){return oe.createWithinCacheScope(e,t)}addScopeNode(e,t,n,r){let o=t.getDeclarations();if(o===void 0)return;let s,l=0;for(let c of o){if(c.getSourceFile()!==r){l++;continue}let f=B.default.Nodes.getParentOfKind(c,n);if(f===void 0)return;if(s===void 0)s=f;else if(s!==f)return}if(l<o.length)if(s!==void 0)e.add(s);else return;return e}createCacheInfo(e,t){return t!==void 0?{emitMode:e,scope:t}:void 0}handleSymbol(e,t,n){if(this.result===void 0)return!0;let r=this.getEmitDataForSymbol(e,t);if(r.length===0)return!0;for(let o of r)if(o.kind==="typeAlias"){if(this.skipNode(o.node))continue;let s=new U(this.context,this.symbols,this.getActiveSourceFile());if(s.addDeclaration(o.node),n===void 0||n===!1)this.result.addSnippet(s,this.location,void 0);else if(!this.result.addSnippet(s,this.location,void 0,n))return!1}else if(o.kind==="symbol"){let{symbol:s,name:l}=o;if(this.skipSymbolBasedOnDeclaration(s)||B.Symbols.isTypeParameter(s))continue;let c=B.Symbols.createKey(s,this.session.host);if(c!==void 0&&this.result.addFromKnownItems(c))continue;let f=new U(this.context,this.symbols,this.getActiveSourceFile());if(f.addTypeSymbol(s,l),n===void 0||n===!1)this.result.addSnippet(f,this.location,c);else if(!this.result.addSnippet(f,this.location,c,n))return!1}return!0}isNodeArray(e){return Array.isArray(e)}skipNode(e){return this.skipSourceFile(e.getSourceFile())}skipSourceFile(e){if(this.getActiveSourceFile().fileName===e.fileName)return!0;let t=this.getProgram();return t.isSourceFileDefaultLibrary(e)||t.isSourceFileFromExternalLibrary(e)}skipSymbolBasedOnDeclaration(e){let t=e.getDeclarations();if(t===void 0||t.length===0)return!1;for(let n of t)if(this.skipSourceFile(n.getSourceFile()))return!0;return!1}getSymbolsForTypeNode(e){let t=[];return this.doGetSymbolsForTypeNode(t,e),t}doGetSymbolsForTypeNode(e,t){if(J.isTypeReferenceNode(t)){let n=this.symbols.getLeafSymbolAtLocation(t.typeName);n!==void 0&&e.push({symbol:n,name:t.typeName.getText()})}else if(J.isUnionTypeNode(t)||J.isIntersectionTypeNode(t))for(let n of t.types)this.doGetSymbolsForTypeNode(e,n)}getSymbolsToEmitForType(e){let t=[];return this.doGetSymbolsForType(t,e),t}doGetSymbolsForType(e,t){let n=t.getSymbol();if(n!==void 0)e.push({symbol:n,name:n.getName()});else if(B.Types.isIntersection(t)||B.Types.isUnion(t))for(let r of t.types)this.doGetSymbolsForType(e,r)}getEmitDataForSymbol(e,t){let n=[];return this.doGetEmitDataForSymbol(n,new Set,0,e,t),n}doGetEmitDataForSymbol(e,t,n,r,o){if(B.Symbols.isAlias(r)&&(r=this.symbols.getLeafSymbol(r)),!(t.has(r)||n>2))if(t.add(r),B.Symbols.isTypeAlias(r)){let s=r.getDeclarations();if(s===void 0||s.length===0)return;let l;for(let f of s)if(J.isTypeAliasDeclaration(f)){l=f;break}if(l===void 0)return;o=o??l.name.getText();let c=l.type;if(J.isTypeLiteralNode(c)){let f=this.symbols.getLeafSymbolAtLocation(c);if(f!==void 0){if(t.has(f))return;e.push({kind:"symbol",symbol:f,name:o})}}else if(J.isTypeReferenceNode(c)){let f=this.symbols.getLeafSymbolAtLocation(c.typeName);if(f!==void 0){if(t.has(f))return;this.doGetEmitDataForSymbol(e,t,n+1,f,o)}}else if(J.isUnionTypeNode(c)||J.isIntersectionTypeNode(c)){if(e.push({kind:"typeAlias",node:l}),n>=2)return;for(let f of c.types){let S=this.symbols.getLeafSymbolAtLocation(f);if(S!==void 0){if(t.has(S))continue;B.Symbols.isTypeLiteral(S)||this.doGetEmitDataForSymbol(e,t,n+1,S,o)}else{let b=this.getSymbolsForTypeNode(f);for(let{symbol:x,name:R}of b)t.has(x)||this.doGetEmitDataForSymbol(e,t,n+1,x,R)}}}}else e.push({kind:"symbol",symbol:r,name:o})}},Ue=class{cachedRunnableResults;primary;secondary;tertiary;constructor(e){this.cachedRunnableResults=e,this.primary=[],this.secondary=[],this.tertiary=[]}addPrimary(e){this.primary.push(this.useCachedRunnableIfPossible(e))}addSecondary(e){this.secondary.push(this.useCachedRunnableIfPossible(e))}addTertiary(e){this.tertiary.push(this.useCachedRunnableIfPossible(e))}*entries(){for(let e of this.primary)yield e;for(let e of this.secondary)yield e;for(let e of this.tertiary)yield e}getPrimaryRunnables(){return this.primary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}getSecondaryRunnables(){return this.secondary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}getTertiaryRunnables(){return this.tertiary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}useCachedRunnableIfPossible(e){let t=this.cachedRunnableResults.get(e.id);return t===void 0?e:e.useCachedResult(t)?new Ft(t,e.priority,e.cost):e}},Y=class{constructor(){}isCallableProvider},we=class extends Error{constructor(){super("Budget exhausted")}},Ne=class{charBudget;lowWaterMark;itemRejected;constructor(e,t=256){this.charBudget=e,this.lowWaterMark=t,this.itemRejected=!1}spent(e){this.charBudget-=e}hasRoom(e){let t=this.charBudget-this.lowWaterMark>=e;return t||(this.itemRejected=!0),t}isExhausted(){return this.charBudget<=0}wasItemRejected(){return this.itemRejected}throwIfExhausted(){if(this.charBudget<=0)throw new we}spentAndThrowIfExhausted(e){this.spent(e),this.throwIfExhausted()}}});var Ae,v,We,Le,kt,pe,fe,me,ye,Ce,Re=V(()=>{"use strict";z();De();ue();Z();Ae=ie(re()),v=A(),We=class d extends H{static VersionTraitKey=Q.createContextItemKey("version");static traitsToCollect=[["module","The TypeScript module system used in this project is ",Q.createContextItemKey("module"),v.ModuleKind],["moduleResolution","The TypeScript module resolution strategy used in this project is ",Q.createContextItemKey("moduleResolution"),v.ModuleResolutionKind],["target","The target version of JavaScript for this project is ",Q.createContextItemKey("target"),v.ScriptTarget],["lib","Library files that should be included in TypeScript compilation are ",Q.createContextItemKey("lib"),void 0]];sourceFile;constructor(e,t,n,r){super(e,t,n,"CompilerOptionsRunnable",0,.7,1),this.sourceFile=r}getActiveSourceFile(){return this.sourceFile}createRunnableResult(e){let t={emitMode:"clientBased",scope:{kind:"file"}};return e.createRunnableResult(this.id,this.priority,"emit",t)}run(e,t){let n=this.getProgram().getCompilerOptions();e.addFromKnownItems(d.VersionTraitKey)||e.addTrait("version","The TypeScript version used in this project is ",v.version);for(let[r,o,s,l]of d.traitsToCollect){if(e.addFromKnownItems(s))continue;let c=n[r];if(c){if(typeof c=="number"){let f=d.getEnumName(l,c);f&&(c=f)}e.addTrait(r,o,c.toString())}}}static getEnumName(e,t){return Object.keys(e).find(n=>e[n]===t)}},Le=class extends H{declaration;sourceFile;constructor(e,t,n,r,o,s,l){super(e,t,n,r,0,s,l),this.declaration=o,this.sourceFile=o.getSourceFile()}getActiveSourceFile(){return this.sourceFile}getCacheScope(){let e=this.declaration.body;if(!(e===void 0||!v.isBlock(e)))return super.createCacheScope(e,this.sourceFile)}},kt=class d extends Le{constructor(e,t,n,r,o=.9){super(e,t,n,d.computeId(e,r),r,o,1)}createRunnableResult(e){let t=this.getCacheScope(),n=t!==void 0?{emitMode:"clientBased",scope:t}:void 0,r=e.createRunnableResult(this.id,this.priority,"emit",n);return r.debugPath=this.getDebugPath(),r}run(e,t){let n=this.declaration.parameters;for(let o=0;o<n.length;o++){t.throwIfCancellationRequested();let l=this.declaration.parameters[o].type;l!==void 0&&this.processType(e,l,t)}let r=this.declaration.type;r!==void 0&&(t.throwIfCancellationRequested(),this.processType(e,r,t))}processType(e,t,n){let r=this.getSymbolsForTypeNode(t);if(r.length!==0)for(let o of r)n.throwIfCancellationRequested(),this.handleSymbol(o.symbol,o.name)}getDebugPath(){if(!this.session.host.isDebugging())return;let{sourceFile:e,startPos:t,endPos:n}=d.getSourceFileAndPositions(this.declaration),r=v.getLineAndCharacterOfPosition(e,t),o=v.getLineAndCharacterOfPosition(e,n);return`SignatureRunnable:${e.fileName}:[${r.line},${r.character},${o.line},${o.character}]`}static computeId(e,t){let{sourceFile:n,startPos:r,endPos:o}=d.getSourceFileAndPositions(t),s=e.host.createHash("md5");return s.update(n.fileName),s.update(`[${r},${o}]`),`SignatureRunnable:${s.digest("base64")}`}static getSourceFileAndPositions(e){let t=e.parameters.pos,n=e.type?.end??e.parameters.end;return{sourceFile:e.getSourceFile(),startPos:t,endPos:n}}},pe=class extends H{tokenInfo;excludes;cacheScope;runnableResult;constructor(e,t,n,r,o,s,l=.9){super(e,t,n,"TypeOfLocalsRunnable",0,l,2),this.tokenInfo=r,this.excludes=o,this.cacheScope=s,this.runnableResult=void 0}getActiveSourceFile(){return this.tokenInfo.token.getSourceFile()}createRunnableResult(e){let t=this.cacheScope!==void 0?{emitMode:"clientBasedOnTimeout",scope:this.cacheScope}:void 0;return this.runnableResult=e.createRunnableResult(this.id,this.priority,"emit",t),this.runnableResult}run(e,t){let n=this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching,o=this.symbols.getTypeChecker(),s=o.getSymbolsInScope(n,v.SymbolFlags.BlockScopedVariable);if(s.length===0)return;let l=n.getSourceFile(),c=this.cacheScope===void 0?new Set:void 0;for(let f of s){if(t.throwIfCancellationRequested(),this.excludes.has(f))continue;let S=Ae.Symbols.getDeclaration(f,v.SyntaxKind.VariableDeclaration);if(S===void 0)continue;let b;if(S.type!==void 0)b=this.getSymbolsForTypeNode(S.type);else{let x=o.getTypeAtLocation(S.type??S);x!==void 0&&(b=this.getSymbolsToEmitForType(x))}if(!(b===void 0||b.length===0)){for(let{symbol:x,name:R}of b)t.throwIfCancellationRequested(),this.handleSymbol(x,R);c!==void 0&&(c=this.addScopeNode(c,f,v.SyntaxKind.VariableDeclarationList,l))}}c!==void 0&&c.size>0&&this.runnableResult!==void 0&&this.runnableResult.setCacheInfo({emitMode:"clientBasedOnTimeout",scope:oe.createOutsideCacheScope(c,l)})}},fe=class d extends H{tokenInfo;static SymbolsToInclude=v.SymbolFlags.Class|v.SymbolFlags.Interface|v.SymbolFlags.TypeAlias|v.SymbolFlags.Enum|v.SymbolFlags.Function;constructor(e,t,n,r,o=.3){super(e,t,n,"TypesOfNeighborFilesRunnable",1,o,2),this.tokenInfo=r}getActiveSourceFile(){return this.tokenInfo.token.getSourceFile()}createRunnableResult(e){let t={emitMode:"clientBased",scope:{kind:"neighborFiles"}};return e.createRunnableResult(this.id,this.priority,"emit",t)}run(e,t){let n=this.symbols;for(let r of this.context.neighborFiles){if(t.throwIfCancellationRequested(),e.isSecondaryBudgetExhausted())return;let o=this.getProgram().getSourceFile(r);if(o===void 0||this.skipSourceFile(o))continue;let s=n.getLeafSymbolAtLocation(o);if(s!==void 0&&s.exports!==void 0)for(let l of s.exports){t.throwIfCancellationRequested();let c=l[1];if((c.flags&d.SymbolsToInclude)!==0&&!this.handleSymbol(c,l[0],!0))return}}}},me=class d extends H{tokenInfo;excludes;cacheInfo;runnableResult;static CacheNodes=new Set([v.SyntaxKind.FunctionDeclaration,v.SyntaxKind.ArrowFunction,v.SyntaxKind.FunctionExpression,v.SyntaxKind.Constructor,v.SyntaxKind.MethodDeclaration,v.SyntaxKind.ClassDeclaration,v.SyntaxKind.ModuleDeclaration]);constructor(e,t,n,r,o,s=.4){super(e,t,n,"ImportsRunnable",1,s,2),this.tokenInfo=r,this.excludes=o,this.runnableResult=void 0;let l=this.getCacheScopeNode();this.cacheInfo=l===void 0?void 0:{emitMode:"clientBased",scope:this.createCacheScope(l)}}getActiveSourceFile(){return this.tokenInfo.token.getSourceFile()}useCachedResult(e){let t=e.cache;if(t===void 0)return!1;if(t.emitMode==="clientBased"&&e.state==="finished"){let n=t.scope;if(n.kind==="withinRange")return!0;if(n.kind==="outsideRange")return this.cacheInfo===void 0}return super.useCachedResult(e)}createRunnableResult(e){return this.runnableResult=e.createRunnableResult(this.id,this.priority,"emit",this.cacheInfo),this.runnableResult}run(e,t){t.throwIfCancellationRequested();let r=(this.tokenInfo.touching??this.tokenInfo.token).getSourceFile(),o=this.getImportBlocks(r);t.throwIfCancellationRequested();let s=[],l;for(let c of o){for(let f of c.imports){if(t.throwIfCancellationRequested(),f.importClause===void 0)continue;let S=f.importClause;if(S.name!==void 0){let b=this.symbols.getLeafSymbolAtLocation(S.name);b!==void 0&&!this.excludes.has(b)&&s.push({symbol:b,name:S.name.getText()})}else if(S.namedBindings!==void 0){let b=S.namedBindings;if(v.isNamespaceImport(b)){let x=this.symbols.getLeafSymbolAtLocation(b.name);x!==void 0&&!this.excludes.has(x)&&s.push({symbol:x,name:b.name.getText()})}else if(v.isNamedImports(b))for(let x of b.elements){let R=this.symbols.getLeafSymbolAtLocation(x.name);R!==void 0&&!this.excludes.has(R)&&s.push({symbol:R,name:x.name.getText()})}}}if(this.cacheInfo===void 0){l===void 0&&(l=[]);let f=c.before!==void 0?oe.createRange(c.before,r).end:oe.createRange(c.imports[0],r).start,S=c.after!==void 0?oe.createRange(c.after,r).start:oe.createRange(c.imports[c.imports.length-1],r).end;l.push({start:f,end:S})}}for(let{symbol:c,name:f}of s)if((c.flags&(v.SymbolFlags.Class|v.SymbolFlags.Interface|v.SymbolFlags.TypeAlias|v.SymbolFlags.Enum|v.SymbolFlags.Alias|v.SymbolFlags.ValueModule))!==0&&!this.handleSymbol(c,f,!0))break;this.cacheInfo===void 0&&l!==void 0&&l.length>0&&e.setCacheInfo({emitMode:"clientBased",scope:{kind:"outsideRange",ranges:l}})}getImportBlocks(e){if(this.cacheInfo!==void 0){let t=[];for(let n of Ae.default.Nodes.getChildren(e,e))v.isImportDeclaration(n)&&t.push(n);return[{before:void 0,imports:t,after:void 0}]}else{let t=[],n,r,o=[];for(let s of Ae.default.Nodes.getChildren(e,e))v.isImportDeclaration(s)?o.push(s):o.length===0?n=s:(r=s,t.push({before:n,imports:o,after:r}),n=void 0,r=void 0,o=[]);return o.length>0&&t.push({before:n,imports:o,after:r}),t}}getCacheScopeNode(){let e=this.tokenInfo.touching??this.tokenInfo.token;if(e===void 0||e.kind===v.SyntaxKind.EndOfFileToken||e.kind===v.SyntaxKind.Unknown)return;let t;for(;e!==void 0&&e.kind!==v.SyntaxKind.SourceFile;)d.CacheNodes.has(e.kind)&&(t=e),e=e.parent;return t}},ye=class d extends H{expression;constructor(e,t,n,r,o=1){super(e,t,n,"TypeOfExpressionRunnable",0,o,1),this.expression=r}getActiveSourceFile(){return this.expression.getSourceFile()}static create(e,t,n,r,o){let s=r.previous;if(!(s===void 0||s.parent===void 0)&&(v.isIdentifier(s)||s.kind===v.SyntaxKind.DotToken)&&v.isPropertyAccessExpression(s.parent)){let l=this.getRightMostIdentifier(s.parent.expression,0);if(l!==void 0)return new d(e,t,n,l)}}static getRightMostIdentifier(e,t){if(t!==32)switch(e.kind){case v.SyntaxKind.Identifier:return e;case v.SyntaxKind.PropertyAccessExpression:return this.getRightMostIdentifier(e.name,t+1);case v.SyntaxKind.ElementAccessExpression:return this.getRightMostIdentifier(e.argumentExpression,t+1);case v.SyntaxKind.CallExpression:return this.getRightMostIdentifier(e.expression,t+1);default:return}}createRunnableResult(e){return e.createRunnableResult(this.id,this.priority,"ignore")}run(e,t){let n=this.symbols.getLeafSymbolAtLocation(this.expression);if(n===void 0)return;let o=this.symbols.getTypeChecker().getTypeOfSymbolAtLocation(n,this.expression),s=o.getConstructSignatures().concat(o.getCallSignatures()),l=this.expression.getSourceFile();for(let S of s){t.throwIfCancellationRequested();let b=S.getReturnType(),x=b.aliasSymbol??b.getSymbol();if(x===void 0)continue;let R=new U(this.context,this.symbols,l);R.addTypeSymbol(x,x.name),e.addSnippet(R,this.location,void 0)}let c=o.getSymbol();if(c===void 0)return;let f=new U(this.context,this.symbols,l);f.addTypeSymbol(c,c.name),e.addSnippet(f,this.location,void 0)}},Ce=class extends Y{functionLikeDeclaration;tokenInfo;computeContext;isCallableProvider;constructor(e,t,n){super(),this.functionLikeDeclaration=e,this.tokenInfo=t,this.computeContext=n,this.isCallableProvider=!0}provide(e,t,n,r,o){if(o.throwIfCancellationRequested(),e.addPrimary(new kt(t,n,r,this.functionLikeDeclaration)),!this.computeContext.isFirstCallableProvider(this))return;let s=this.getTypeExcludes(n,r);e.addPrimary(new pe(t,n,r,this.tokenInfo,s,oe.fromDeclaration(this.functionLikeDeclaration)));let l=ye.create(t,n,r,this.tokenInfo,o);l!==void 0&&e.addPrimary(l),e.addSecondary(new me(t,n,r,this.tokenInfo,s)),r.neighborFiles.length>0&&e.addTertiary(new fe(t,n,r,this.tokenInfo))}}});var ee,Te,At,Qe,Lt,Ye,Et,en=V(()=>{"use strict";z();De();ue();Z();ee=ie(re()),Te=A(),At=class d extends G{classDeclaration;stateProvider;abstractMembers;extends;implements;constructor(e,t,n,r){if(super(e,t),n instanceof d){let o=n;this.classDeclaration=G.getNodeInProgram(e,o.classDeclaration),this.stateProvider=o.stateProvider,this.abstractMembers=o.abstractMembers;let s=l=>{let c=l.type,f=e.getSourceFile(c.getSourceFile().fileName);if(f!==void 0){let S=ee.default.getTokenAtPosition(f,c.pos);if(Te.isExpressionWithTypeArguments(S)){let b=t.getLeafSymbolAtLocation(S.expression);if(b!==void 0&&!this.getSymbolInfo(b).skip)return{symbol:b,type:S,abstractMembers:l.abstractMembers}}}};if(o.extends!==void 0&&(this.extends=s(o.extends)),o.implements!==void 0){let l;for(let c of o.implements){let f=s(c);f!==void 0&&(l=l??[],l.push(f))}this.implements=l}}else{let o=n;this.classDeclaration=o,this.stateProvider=r;let s=o.heritageClauses;if(s===void 0){this.abstractMembers=0,this.extends=void 0,this.implements=void 0;return}let l=0,c,f;for(let S of s)if(S.token===Te.SyntaxKind.ExtendsKeyword){if(S.types.length===1){let b=S.types[0],x=this.getHeritageSymbol(b.expression);if(x!==void 0&&!this.getSymbolInfo(x).skip){let R=this.getNumberOfAbstractMembers(x);l+=R,c={symbol:x,type:b,abstractMembers:R}}}}else if(S.token===Te.SyntaxKind.ImplementsKeyword)for(let b of S.types){let x=this.getHeritageSymbol(b.expression);if(x!==void 0&&!this.getSymbolInfo(x).skip){f=f??[];let R=this.getNumberOfAbstractMembers(x);l+=R,f.push({symbol:x,type:b,abstractMembers:R})}}f!==void 0&&f.sort((S,b)=>b.abstractMembers-S.abstractMembers),this.abstractMembers=l,this.extends=c,this.implements=f}}with(e){return e===this.program?this:new d(e,new ee.Symbols(e),this)}*all(){this.extends!==void 0&&(yield this.extends),this.implements!==void 0&&(yield*this.implements)}isSame(e){return this.classDeclaration===e||this.classDeclaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.classDeclaration.pos===e.pos}score(e,t){if(this.abstractMembers===0){if(this.extends===void 0)return-1;let l=this.extends.symbol.declarations;if(l===void 0)return-1;for(let c of l)if(e.getSourceFile(c.getSourceFile().fileName)===void 0)return-1;return 1}let n;for(let l of this.all())if(l.symbol.declarations!==void 0)for(let c of l.symbol.declarations){let f=c.getSourceFile();if(e.getSourceFile(f.fileName)!==void 0){n??=0,n+=l.abstractMembers;break}}if(n===void 0)return-1;let r=n/this.abstractMembers,o=t.neighborFiles;if(o.length===0)return r;let s=Math.pow(10,o.length.toString().length);r*=s;for(let l of o)e.getSourceFile(l)!==void 0&&(r+=1);return r}run(e,t){if(this.extends===void 0&&this.implements===void 0)return;let n,r=new Map([...this.all()].map(o=>[o.symbol,o]));for(let o of this.all()){let l=o.symbol.declarations;if(l===void 0)continue;let c=new Set;for(let f of l){if(!Te.isClassDeclaration(f)&&!Te.isInterfaceDeclaration(f)&&!Te.isTypeAliasDeclaration(f)||f.name===void 0)continue;let S=f.getSourceFile();if(c.has(S.fileName))continue;let b=new ee.ReferencedByVisitor(this.program,S,e.getPreferredNeighborFiles(this.program),this.stateProvider,t);for(let x of b.entries()){t.throwIfCancellationRequested();for(let R of ee.ClassDeclarations.entries(x)){if(R.heritageClauses===void 0||this.isSame(R))continue;let w;for(let X of R.heritageClauses)for(let W of X.types){let E=this.getHeritageSymbol(W.expression);if(E===void 0)continue;let M=r.get(E);M!==void 0&&(w??=0,w+=M.abstractMembers)}if(w!==void 0&&(n===void 0?n={declaration:R,matchesAbstractMembers:w}:w>n.matchesAbstractMembers&&(n={declaration:R,matchesAbstractMembers:w})),n!==void 0&&n.matchesAbstractMembers===this.abstractMembers)return n}}}}}getNumberOfAbstractMembers(e){return this.symbols.getMemberStatistic(e).abstract.size}},Qe=class extends H{classDeclaration;constructor(e,t,n,r,o=.8){super(e,t,n,"SuperClassRunnable",0,o,2),this.classDeclaration=r}getActiveSourceFile(){return this.classDeclaration.getSourceFile()}createRunnableResult(e){let t=this.createCacheScope(this.classDeclaration.members,this.classDeclaration.getSourceFile());return e.createRunnableResult(this.id,this.priority,"emit",{emitMode:"clientBased",scope:t})}run(e,t){let n=this.symbols,r=n.getLeafSymbolAtLocation(this.classDeclaration.name??this.classDeclaration);if(r===void 0||!ee.Symbols.isClass(r)||r.declarations===void 0)return;let o=n.getDirectSuperSymbols(r);if(o!==void 0){if(o.extends!==void 0){let{symbol:s,name:l}=o.extends;s!==void 0&&l!==void 0&&this.handleSymbol(s,l)}if(o.implements!==void 0)for(let s of o.implements){let{symbol:l,name:c}=s;l!==void 0&&c!==void 0&&this.handleSymbol(l,c)}}}},Lt=class extends H{classDeclaration;constructor(e,t,n,r,o=.6){super(e,t,n,"SimilarClassRunnable",0,o,3),this.classDeclaration=r}getActiveSourceFile(){return this.classDeclaration.getSourceFile()}createRunnableResult(e){return e.createRunnableResult(this.id,this.priority,"emit")}run(e,t){let n=this.getProgram(),r=this.classDeclaration,o=this.symbols.getLeafSymbolAtLocation(r.name??r);if(o===void 0||!ee.Symbols.isClass(o))return;let s=new At(n,this.symbols,r);if(s.extends===void 0&&s.implements===void 0)return;let[l,c]=this.session.run(s,this.context,t);if(l===void 0||c===void 0)return;let f=new U(this.context,this.context.getSymbols(l),r.getSourceFile());f.addDeclaration(c.declaration),e.addSnippet(f,this.location,void 0)}},Ye=class d extends Y{static create(e,t){return e.members===void 0||e.members.length===0?new Et(e,t):new d(e,t)}classDeclaration;constructor(e,t){super(),this.classDeclaration=e}provide(e,t,n,r,o){o.throwIfCancellationRequested(),e.addPrimary(new Qe(t,n,r,this.classDeclaration))}},Et=class extends Y{classDeclaration;constructor(e,t){super(),this.classDeclaration=e}provide(e,t,n,r,o){o.throwIfCancellationRequested(),e.addPrimary(new Qe(t,n,r,this.classDeclaration)),t.enableBlueprintSearch()&&e.addPrimary(new Lt(t,n,r,this.classDeclaration))}}});var ve,tn=V(()=>{"use strict";Re();ve=class extends Ce{functionDeclaration;constructor(e,t,n){super(e,t,n),this.functionDeclaration=e}provide(e,t,n,r,o){super.provide(e,t,n,r,o)}getTypeExcludes(){return new Set}}});var K,L,Xe,Ee,Ze,Mt,Bt,qt,et,Ot,Me,tt,nt,Be,_t,Vt,it,nn=V(()=>{"use strict";z();Re();De();ue();Z();Fe();K=ie(re()),L=A(),Xe=class extends G{declaration;stateProvider;constructor(e,t,n,r){super(e,t),this.declaration=n,this.stateProvider=r}isSame(e){return this.declaration===e||this.declaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.declaration.pos===e.pos}score(e,t){if(e.getSourceFile(this.declaration.getSourceFile().fileName)===void 0)return 0;let n=t.neighborFiles;if(n.length===0)return 1;let r=Math.pow(10,n.length.toString().length);for(let o of n)e.getSourceFile(o)!==void 0&&(r+=1);return r}},Ee=class extends Xe{constructor(e,t,n,r){super(e,t,n,r)}static create(e,t,n,r){let o=n.parent;if(!L.isClassDeclaration(o))return;let s=K.Declarations.isPrivate(n),l=[],c;if(!s){let f=t.getLeafSymbolAtLocation(o.name!==void 0?o.name:o);if(f===void 0||!K.Symbols.isClass(f))return;let S=L.escapeLeadingUnderscores(n.name.getText()),b,x=!1;for(let[R,w]of t.getAllSuperTypesWithPath(f)){if(f===R&&(x=!1,b=[]),x)continue;b.push(w);let X=w.members?.get(S);if(X!==void 0){if(K.Symbols.isInterface(w)||K.Symbols.isTypeLiteral(w))l.push(...b),x=!0;else if(K.Symbols.isClass(w))if(K.Symbols.isAbstract(X)){c=w;break}else{c=w;break}}}}if(s){let f=K.ClassDeclarations.getExtendsClause(o);if(f===void 0||f.types.length===0)return;{let S=t.getLeafSymbolAtLocation(f.types[0].expression);return S===void 0||!K.Symbols.isClass(S)?void 0:new Mt(e,t,o,S,n,r)}}else{if(c!==void 0)return new Bt(e,t,o,n,c,r);if(l.length>0){let f=l.filter(S=>{if(K.Symbols.isTypeLiteral(S))return!1;let b=S.escapedName;return!(b==="__type"||b==="__class")});return new qt(e,t,o,n,f,r)}else return}}},Ze=class d extends Xe{classDeclaration;extendsSymbol;constructor(e,t,n,r,o,s){if(n instanceof d){let l=n,c=G.getNodeInProgram(e,l.declaration);super(e,t,c,l.stateProvider),this.classDeclaration=G.getNodeInProgram(e,l.classDeclaration);let f=l.extendsSymbol.declarations;if(f===void 0||f.length===0)throw new Error("No declarations found for extends symbol");let S;for(let b of f)if(L.isClassDeclaration(b)){let x=K.ClassDeclarations.getExtendsClause(b);if(x===void 0||x.types.length===0)throw new Error("No extends clause found");if(S=this.symbols.getLeafSymbolAtLocation(x.types[0].expression),S===void 0||!K.Symbols.isClass(S))throw new Error("No extends symbol found");break}if(S===void 0)throw new Error("No extends symbol found");this.extendsSymbol=S}else super(e,t,o,s),this.classDeclaration=n,this.extendsSymbol=r}run(e,t){let n=this.getMemberName();for(let r of this.symbols.getDirectSubTypes(this.extendsSymbol,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),r.members!==void 0){let o=r.members.get(n);if(o===void 0)continue;let s=o.declarations;if(s===void 0||s.length===0)continue;for(let l of s){if(l.kind!==this.declaration.kind)continue;let c=l.parent;if(!(!L.isClassDeclaration(c)||c===this.classDeclaration))return c}}}},Mt=class d extends Ze{constructor(e,t,n,r,o,s){n instanceof d?super(e,t,n):super(e,t,n,r,o,s)}with(e){return e===this.program?this:new d(e,new K.Symbols(e),this)}getMemberName(){return L.escapeLeadingUnderscores(this.declaration.name.getText())}},Bt=class d extends Ee{classDeclaration;startClass;constructor(e,t,n,r,o,s){if(n instanceof d){let l=n,c=G.getNodeInProgram(e,l.declaration);super(e,t,c,l.stateProvider),this.classDeclaration=G.getNodeInProgram(e,l.classDeclaration);let S=l.startClass.declarations;if(S===void 0||S.length===0)throw new N("No declarations found for start class",N.NoDeclaration);let b;for(let x of S)if(L.isClassDeclaration(x)&&(b=this.symbols.getLeafSymbolAtLocation(x.name?x.name:x),b!==void 0))break;if(b===void 0)throw new N("No symbol found for start class",N.SymbolNotFound);this.startClass=b}else super(e,t,r,s),this.classDeclaration=n,this.startClass=o}with(e){return e===this.program?this:new d(e,new K.Symbols(e),this)}run(e,t){if(!K.Symbols.isClass(this.startClass))return;let n=L.escapeLeadingUnderscores(this.declaration.name.getText());for(let r of this.symbols.getAllSubTypes(this.startClass,K.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),r.members!==void 0){let o=r.members.get(n);if(o===void 0)continue;let s=o.declarations;if(s===void 0||s.length===0)continue;for(let l of s){if(!L.isMethodDeclaration(l))continue;let c=l.parent;if(!(!L.isClassDeclaration(c)||c===this.classDeclaration))return c}}}},qt=class d extends Ee{classDeclaration;typesToCheck;constructor(e,t,n,r,o,s){if(n instanceof d){let l=n,c=G.getNodeInProgram(e,l.declaration);super(e,t,c,l.stateProvider),this.classDeclaration=G.getNodeInProgram(e,l.classDeclaration);let f=[];for(let S of l.typesToCheck){let b=S.declarations;if(b===void 0||b.length===0)throw new N("No declarations found for start class",N.NoDeclaration);let x;for(let R of b)if(!(!L.isClassDeclaration(R)&&!L.isInterfaceDeclaration(R))&&(x=this.symbols.getLeafSymbolAtLocation(R.name?R.name:R),x!==void 0&&x.flags===S.flags))break;if(x===void 0)throw new N("No symbol found for start class",N.SymbolNotFound);f.push(x)}this.typesToCheck=f}else super(e,t,r,s),this.classDeclaration=n,this.typesToCheck=o}with(e){return e===this.program?this:new d(e,new K.Symbols(e),this)}run(e,t){let n=L.escapeLeadingUnderscores(this.declaration.name.getText()),r=new Set(this.typesToCheck),o=[];for(let l of this.typesToCheck){t.throwIfCancellationRequested();for(let c of this.symbols.getDirectSubTypes(l,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!r.has(c)){if(K.Symbols.isClass(c)){let f=c.members?.get(n);if(f!==void 0&&!K.Symbols.isAbstract(f)){let S=K.ClassDeclarations.fromSymbol(c);if(S===this.classDeclaration)continue;if(S!==void 0)return S}}o.push(c)}}let s=new Set;for(let l of o)if(t.throwIfCancellationRequested(),!s.has(l)){for(let c of this.symbols.getAllSubTypes(l,K.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!s.has(c)){if(K.Symbols.isClass(c)){let f=c.members?.get(n);if(f!==void 0&&!K.Symbols.isAbstract(f)){let S=K.ClassDeclarations.fromSymbol(c);if(S===this.classDeclaration){s.add(c);continue}if(S!==void 0)return S}}s.add(c)}s.add(l)}}},et=class extends Le{constructor(e,t,n,r,o=.6){super(e,t,n,"SimilarPropertyRunnable",r,o,3)}createRunnableResult(e){let t=this.getCacheScope(),n=t!==void 0?{emitMode:"clientBased",scope:t}:void 0;return e.createRunnableResult(this.id,this.priority,"emit",n)}run(e,t){let n=this.createSearch(t);if(n!==void 0){let[r,o]=this.session.run(n,this.context,t);if(r!==void 0&&o!==void 0){if(this.symbols.getLeafSymbolAtLocation(o.name?o.name:o)===void 0)return;let l=this.declaration.getSourceFile(),c=new U(this.context,this.context.getSymbols(r),l);c.addDeclaration(o),e.addSnippet(c,this.location,void 0)}}}},Ot=class extends et{constructor(e,t,n,r){super(e,t,n,r)}createSearch(){return Ee.create(this.getProgram(),this.symbols,this.declaration,this.session)}},Me=class extends Ce{declaration;isCallableProvider;constructor(e,t,n){super(e,t,n),this.declaration=e,this.isCallableProvider=!0}getTypeExcludes(e,t){let n=new Set,r=this.declaration.parent;if(L.isClassDeclaration(r)&&r.heritageClauses!==void 0&&r.heritageClauses.length>0){let o=e.getProgram();if(o!==void 0){let s=t.getSymbols(o);for(let l of r.heritageClauses)if(l.token===L.SyntaxKind.ExtendsKeyword)for(let c of l.types){let f=s.getLeafSymbolAtLocation(c.expression);if(f!==void 0&&K.Symbols.isClass(f))return n.add(f)}}}return n}},tt=class d extends H{declaration;constructor(e,t,n,r,o=.5){super(e,t,n,"PropertiesTypeRunnable",1,o,2),this.declaration=r}getActiveSourceFile(){return this.declaration.getSourceFile()}createRunnableResult(e){let t={emitMode:"clientBased",scope:this.createCacheScope(this.declaration)};return e.createRunnableResult(this.id,this.priority,"emit",t)}run(e,t){let n=this.declaration.parent;if(!L.isClassDeclaration(n))return;let r=this.getProgram(),o=this.context.getSymbols(r),s=o.getLeafSymbolAtLocation(n.name?n.name:n);if(!(s===void 0||!K.Symbols.isClass(s))){if(s.members!==void 0){for(let l of s.members.values())if(t.throwIfCancellationRequested(),!this.handleMember(e,l,o,L.ModifierFlags.Private|L.ModifierFlags.Protected))return}for(let l of o.getAllSuperClasses(s))if(t.throwIfCancellationRequested(),l.members!==void 0){for(let c of l.members.values())if(t.throwIfCancellationRequested(),!this.handleMember(e,c,o,L.ModifierFlags.Public|L.ModifierFlags.Protected))return}}}handleMember(e,t,n,r){if(!K.Symbols.hasModifierFlags(t,r))return!0;let o=!0;for(let[s,l]of this.getEmitMemberData(t,n))if(s!==void 0&&(o=o&&this.handleSymbol(s,l,!0),!o))break;return o}static NoEmitData=Object.freeze([void 0,void 0]);*getEmitMemberData(e,t){if(K.Symbols.isProperty(e)){let r=t.getTypeChecker().getTypeOfSymbol(e).symbol;if(r===void 0)return;r=t.getLeafSymbol(r);let o,s=K.Symbols.getDeclaration(e,L.SyntaxKind.PropertyDeclaration);s!==void 0&&s.type!==void 0&&(o=K.default.Nodes.getTypeName(s.type)),yield[r,o];return}else if(K.Symbols.isMethod(e)){let r=t.getTypeChecker().getTypeOfSymbol(e).getCallSignatures();if(r.length===0)return;for(let o of r){let s=o.getReturnType().symbol;s===void 0&&(yield d.NoEmitData),s=t.getLeafSymbol(s);let l,c=o.getDeclaration();c!==void 0&&c.type!==void 0&&(l=K.default.Nodes.getTypeName(c.type)),yield[s,l]}}}},nt=class extends Me{constructor(e,t,n){super(e,t,n)}provide(e,t,n,r,o){t.enableBlueprintSearch()&&e.addPrimary(new Ot(t,n,r,this.declaration)),super.provide(e,t,n,r,o),e.addSecondary(new tt(t,n,r,this.declaration))}},Be=class extends Me{constructor(e,t,n){super(e,t,n)}provide(e,t,n,r,o){super.provide(e,t,n,r,o),e.addSecondary(new tt(t,n,r,this.declaration))}},_t=class d extends Ze{constructor(e,t,n,r,o,s){n instanceof d?super(e,t,n):super(e,t,n,r,o,s)}with(e){return e===this.program?this:new d(e,new K.Symbols(e),this)}getMemberName(){return L.InternalSymbolName.Constructor}},Vt=class extends et{constructor(e,t,n,r){super(e,t,n,r)}createSearch(){let e=this.declaration.parent;if(!L.isClassDeclaration(e))return;let t=K.ClassDeclarations.getExtendsClause(e);if(!(t===void 0||t.types.length===0)){let n=this.symbols.getLeafSymbolAtLocation(t.types[0].expression);return n===void 0||!K.Symbols.isClass(n)?void 0:new _t(this.getProgram(),this.symbols,e,n,this.declaration,this.session)}}},it=class extends Me{constructor(e,t,n){super(e,t,n)}provide(e,t,n,r,o){t.enableBlueprintSearch()&&e.addPrimary(new Vt(t,n,r,this.declaration)),super.provide(e,t,n,r,o)}}});var rt,rn=V(()=>{"use strict";Re();ue();rt=class extends Y{declaration;tokenInfo;computeInfo;isCallableProvider;constructor(e,t,n){super(),this.declaration=e,this.tokenInfo=t,this.computeInfo=n,this.isCallableProvider=!0}provide(e,t,n,r,o){if(o.throwIfCancellationRequested(),!this.computeInfo.isFirstCallableProvider(this))return;let s=new Set;e.addPrimary(new pe(t,n,r,this.tokenInfo,s,void 0));let l=ye.create(t,n,r,this.tokenInfo,o);l!==void 0&&e.addPrimary(l),e.addSecondary(new me(t,n,r,this.tokenInfo,s,void 0)),r.neighborFiles.length>0&&e.addTertiary(new fe(t,n,r,this.tokenInfo,void 0))}}});function on(d,e,t,n,r,o){let s=new j.Symbols(e),l=s.getLeafSymbolAtLocation(t);if(l===void 0){d.setCanRename("no","No symbol found at location");return}let c=j.Symbols.getParent(l),f=l.getDeclarations();if(f!==void 0){if(f.length===1&&(j.Symbols.isBlockScopedVariable(l)||j.Symbols.isFunctionScopedVariable(l))){let x=s.getTypeChecker().getSymbolsInScope(f[0],se.SymbolFlags.BlockScopedVariable|se.SymbolFlags.FunctionScopedVariable);for(let R of x)if(R!==l&&R.getName()===l.getName()){d.setCanRename("no",`A variable with the name '${n}' already exists in the same scope`);return}}else if(f.length>1){if(j.Symbols.isFunction(l)){if(new st(d,l).checkDeclarations(),d.getCanRename()==="no")return}else if(!j.Symbols.isMethod(l)||c===void 0){d.setCanRename("no","The symbol has multiple declarations");return}else if((j.Symbols.isInterface(c)||j.Symbols.isTypeLiteral(c)||j.Symbols.isClass(c))&&(new st(d,l).checkDeclarations(),d.getCanRename()==="no"))return}}let S=se.escapeLeadingUnderscores(r);if(c!==void 0){let b=c.members;if(b!==void 0&&b.has(S)){d.setCanRename("no",`A member with the name '${r}' already exists on '${c.getName()}'`);return}let x=c.exports;if(x!==void 0&&x.has(S)){d.setCanRename("no",`An export with the name '${r}' already exists on module '${c.getName()}'`);return}if(j.Symbols.isClass(c)||j.Symbols.isInterface(c)){for(let R of s.getAllSuperTypes(c)){let w=R.members;if(w!==void 0&&w.has(S)){d.setCanRename("no",`A member with the name '${r}' already exists on base type '${R.getName()}'`);return}o.throwIfCancellationRequested()}d.setCanRename("yes",n);return}else if(j.Symbols.isEnum(c)||j.Symbols.isConstEnum(c)){d.setCanRename("yes",n);return}}if(o.throwIfCancellationRequested(),f!==void 0&&f.length>0)if(On(s,l,f,r)){d.setCanRename("no",`A symbol with the name '${r}' already exists in the scope`);return}else{d.setCanRename("yes",n);return}else{d.setCanRename("no","The symbol has no declarations");return}}function On(d,e,t,n){let r=d.getTypeChecker(),o;for(let s of t){let l=r.resolveName(n,s,se.SymbolFlags.All,!1);if(l!==void 0)if(o=o??_n(d,t),o){let c=sn(s);if(c===void 0)return!0;if(Vn(l,c))return!0}else return!0}return!1}function _n(d,e){for(let t of e){let n=t.getSourceFile();if(d.getSymbolAtLocation(n)===void 0)return!1}return!0}function Vn(d,e){let t=d.getDeclarations();if(t===void 0)return!1;for(let n of t)if(sn(n)===e)return!0;return!1}function sn(d){let e=d;for(;e!==void 0;){if(e.kind===se.SyntaxKind.Block||e.kind===se.SyntaxKind.ModuleBlock||e.kind===se.SyntaxKind.SourceFile)return e;e=e.parent}}var j,se,ot,st,Ht=V(()=>{"use strict";z();Z();j=ie(re()),se=A(),ot=class{canRename;oldName;reason;timedOut;onOldState;constructor(){this.canRename=void 0,this.oldName=void 0,this.reason=void 0,this.timedOut=!1,this.onOldState=!1}getCanRename(){return this.canRename}setCanRename(e,t,n){return this.canRename=e,e!=="no"?(this.oldName=t,n!==void 0&&(this.onOldState=n)):this.reason=t,this}setOnOldState(e){if(this.canRename==="no")throw new Error("Cannot set onOldState when canRename is no");return this.onOldState=e,this}setTimedOut(e){return this.timedOut=e,this}toJsonResponse(){return this.timedOut?{canRename:"no",reason:this.reason,timedOut:this.timedOut}:this.canRename==="yes"||this.canRename==="maybe"?{canRename:this.canRename,oldName:this.oldName,onOldState:this.onOldState}:{canRename:"no",timedOut:!1,reason:this.reason}}},st=class{result;symbol;constructor(e,t){this.result=e,this.symbol=t}checkDeclarations(){let e=this.symbol.getDeclarations();if(e===void 0||e.length<=1)return;let t=0,n=new Set;for(let r of e){if((se.isMethodDeclaration(r)||se.isFunctionDeclaration(r))&&r.body!==void 0){if(t++,t===2){this.result.setCanRename("no","The symbol has multiple declarations with body");return}continue}let o=r.getText();if(n.has(o)){this.result.setCanRename("no","The symbol has multiple identical declarations");return}else n.add(o)}}}});var qe,jt,at,an=V(()=>{"use strict";z();Re();ue();Z();qe=A(),jt=class extends H{tokenInfo;constructor(e,t,n,r){super(e,t,n,"GlobalsRunnable",1,.2,2),this.tokenInfo=r}getActiveSourceFile(){return this.tokenInfo.token.getSourceFile()}createRunnableResult(e){return e.createRunnableResult(this.id,this.priority,"emit",{emitMode:"clientBased",scope:{kind:"file"}})}run(e,t){let n=this.symbols,r=this.tokenInfo.token.getSourceFile(),o=this.getSymbolsInScope(n.getTypeChecker(),r);t.throwIfCancellationRequested();for(let s of o)if(t.throwIfCancellationRequested(),!this.handleSymbol(s,void 0,!0))break}getSymbolsInScope(e,t){let n=[],r=e.getSymbolsInScope(t,qe.SymbolFlags.Function|qe.SymbolFlags.Class|qe.SymbolFlags.Interface|qe.SymbolFlags.TypeAlias|qe.SymbolFlags.ValueModule);for(let o of r)this.skipSymbolBasedOnDeclaration(o)||n.push(this.symbols.getLeafSymbol(o));return n}},at=class extends Y{tokenInfo;computeInfo;isCallableProvider;constructor(e,t){super(),this.tokenInfo=e,this.computeInfo=t,this.isCallableProvider=!0}provide(e,t,n,r,o){if(o.throwIfCancellationRequested(),e.addSecondary(new jt(t,n,r,this.tokenInfo)),!this.computeInfo.isFirstCallableProvider(this))return;e.addPrimary(new pe(t,n,r,this.tokenInfo,new Set,void 0));let s=ye.create(t,n,r,this.tokenInfo,o);s!==void 0&&e.addPrimary(s),e.addSecondary(new me(t,n,r,this.tokenInfo,new Set,void 0)),r.neighborFiles.length>0&&e.addTertiary(new fe(t,n,r,this.tokenInfo))}}});function ln(d,e,t,n,r,o){let s=t.getProgram();if(s===void 0){d.addErrorData(new N("No program found on language service",N.NoProgram));return}let l=s.getSourceFile(n);if(l===void 0){d.addErrorData(new N("No source file found for document",N.NoSourceFile));return}let c=Ie.default.getRelevantTokens(l,r);new Gt(c).execute(d,e,t,o)}function dn(d,e,t,n,r,o,s,l,c){if(typeof o!="string"||o.length===0){d.setCanRename("no","No old name provided");return}if(typeof s!="string"||s.length===0){d.setCanRename("no","No new name provided");return}let f=t.getProgram();if(f===void 0){d.setCanRename("no","No program found on language service");return}let S=f.getSourceFile(n);if(S===void 0){d.setCanRename("no","No source file found for document");return}let b=t.getRenameInfo(n,r,{});if(!b.canRename){if(l!==void 0){Hn(d,e,t,S,r,o,s,l,c);return}d.setCanRename("no",b.localizedErrorMessage);return}if(b.displayName!==o){d.setCanRename("no",`Old name '${o}' does not match symbol name '${b.displayName}'`);return}cn(d,f,S,r,o,s,c)}function cn(d,e,t,n,r,o,s){let l=Ie.default.getRelevantTokens(t,n);if(l.token===void 0){d.setCanRename("no","No token found at position");return}d.setCanRename("maybe",r),s.throwIfCancellationRequested(),on(d,e,l.token,r,o,s)}function Hn(d,e,t,n,r,o,s,l,c){let[f,S]=pn(n,r,o,s,l);Ie.default.LanguageServiceHost.runWithTemporaryFileUpdate(e.languageServiceHost,n.fileName,f,(b,x,R)=>{let w=t.getRenameInfo(R.fileName,S,{});if(!w.canRename){d.setCanRename("no",w.localizedErrorMessage);return}if(w.displayName!==o){d.setCanRename("no",`Old name '${o}' does not match symbol name '${w.displayName}'`);return}cn(d,b,R,S,o,s,c),(d.getCanRename()==="maybe"||d.getCanRename()==="yes")&&d.setOnOldState(!0)})}function un(d,e,t,n,r,o,s){if(r===void 0||o===void 0||s===void 0)return[];let l=e.getProgram();if(l===void 0)return[];let c=l.getSourceFile(t);if(c===void 0)return[];let[f,S]=pn(c,n,r,o,s),b=o.length-r.length,x=new Map;return Ie.default.LanguageServiceHost.runWithTemporaryFileUpdate(d.languageServiceHost,c.fileName,f,(R,w,X)=>{let W=e.findRenameLocations(X.fileName,S,!1,!1,{});if(W!==void 0)for(let E of W){let M=x.get(E.fileName);M===void 0&&(M={file:E.fileName,changes:[]},x.set(E.fileName,M));let Ke=R.getSourceFile(E.fileName);if(Ke===void 0)continue;let te=Ke.getLineAndCharacterOfPosition(E.textSpan.start),ne=Ke.getLineAndCharacterOfPosition(E.textSpan.start+E.textSpan.length);E.fileName===t&&te.line===s.start.line&&te.character===s.start.character&&ne.line===s.end.line&&ne.character===s.end.character-b||M.changes.push({range:{start:{line:te.line,character:te.character},end:{line:ne.line,character:ne.character}},newText:E.prefixText||E.suffixText?(E.prefixText??"")+o+(E.suffixText??""):void 0})}}),Array.from(x.values())}function pn(d,e,t,n,r){let o=d.getFullText(),s=d.getPositionOfLineAndCharacter(r.start.line,r.start.character),l=d.getPositionOfLineAndCharacter(r.end.line,r.end.character);return[o.substring(0,s)+t+o.substring(l),e<s?e:e-(n.length-t.length)]}var Ie,$,Jt,Gt,fn=V(()=>{"use strict";z();Ie=ie(re());Re();en();ue();tn();nn();rn();Ht();Z();an();Fe();$=A(),Jt=class{firstCallableProvider;constructor(){this.firstCallableProvider=void 0}update(e){return this.firstCallableProvider===void 0&&e.isCallableProvider!==void 0&&e.isCallableProvider===!0&&(this.firstCallableProvider=e),e}isFirstCallableProvider(e){return this.firstCallableProvider===e}},Gt=class d{static Factories=new Map([[$.SyntaxKind.SourceFile,(e,t,n)=>new at(t,n)],[$.SyntaxKind.FunctionDeclaration,(e,t,n)=>new ve(e,t,n)],[$.SyntaxKind.ArrowFunction,(e,t,n)=>new ve(e,t,n)],[$.SyntaxKind.FunctionExpression,(e,t,n)=>new ve(e,t,n)],[$.SyntaxKind.GetAccessor,(e,t,n)=>new Be(e,t,n)],[$.SyntaxKind.SetAccessor,(e,t,n)=>new Be(e,t,n)],[$.SyntaxKind.ClassDeclaration,Ye.create],[$.SyntaxKind.Constructor,(e,t,n)=>new it(e,t,n)],[$.SyntaxKind.MethodDeclaration,(e,t,n)=>new nt(e,t,n)],[$.SyntaxKind.ModuleDeclaration,(e,t,n)=>new rt(e,t,n)]]);tokenInfo;computeInfo;constructor(e){this.tokenInfo=e,this.computeInfo=new Jt}execute(e,t,n,r){let o=this.getContextRunnables(t,n,e.context,r);e.addPath(Ie.default.StableSyntaxKinds.getPath(this.tokenInfo.touching??this.tokenInfo.token));for(let s of o.entries())s.initialize(e);this.executeRunnables(o.getPrimaryRunnables(),e,r),this.executeRunnables(o.getSecondaryRunnables(),e,r),this.executeRunnables(o.getTertiaryRunnables(),e,r),e.done()}executeRunnables(e,t,n){for(let r of e){n.throwIfCancellationRequested();try{r.compute(n)}catch(o){if(o instanceof N)t.addErrorData(o);else throw o}}}getContextRunnables(e,t,n,r){let o=new Ue(n.clientSideRunnableResults);o.addPrimary(new We(e,t,n,this.tokenInfo.token.getSourceFile()));let s=this.computeProviders();for(let l of s)l.provide(o,e,t,n,r);return o}computeProviders(){let e=[],t=this.tokenInfo.touching;if(t===void 0&&(this.tokenInfo.token===void 0||this.tokenInfo.token.kind===$.SyntaxKind.EndOfFileToken?t=this.tokenInfo.previous:t=this.tokenInfo.token),t===void 0||t.kind===$.SyntaxKind.EndOfFileToken)return e;let n=t;for(;n!==void 0;){let r=d.Factories.get(n.kind);if(r!==void 0){let o=r(n,this.tokenInfo,this.computeInfo);o!==void 0&&e.push(this.computeInfo.update(o))}n=n.parent}return e}}});var mn,lt,yn=V(()=>{"use strict";mn=ie(require("crypto")),lt=class{constructor(){}createHash(e){return mn.default.createHash(e)}isDebugging(){return process.execArgv.some(e=>/^--(?:inspect|debug)(?:-brk)?(?:=\d+)?$/i.test(e))}}});var bn={};wn(bn,{LanguageServerSession:()=>ct,create:()=>zn});function zn(d){if(hn)return d.languageService;if(d.session!==void 0)try{d.session.addProtocolHandler("_.copilot.ping",()=>({response:dt,responseRequired:!0}));try{let e=Un();dt={kind:"ok",session:!0,supported:e,version:he.version},e&&(le=new ct(d.session,d.languageServiceHost,new lt),Oe=d.languageServiceHost,d.session.addProtocolHandler("_.copilot.context",jn),d.session.addProtocolHandler("_.copilot.prepareNesRename",Jn),d.session.addProtocolHandler("_.copilot.postNesRename",Gn))}catch(e){e instanceof Error?(dt={kind:"error",message:e.message,stack:e.stack},d.session.logError(e,"_.copilot.installHandler")):(dt={kind:"error",message:"Unknown error"},d.session.logError(new Error("Unknown error"),"_.copilot.installHandler"))}}catch(e){e instanceof Error?d.session.logError(e,"_.copilot.installPingHandler"):d.session.logError(new Error("Unknown error"),"_.copilot.installPingHandler")}finally{hn=!0}return d.languageService}function Un(){try{let d=he.versionMajorMinor.split(".");if(d.length<2)return!1;let e=parseInt(d[0]),t=parseInt(d[1]);return e>5||e===5&&t>=5}catch{return!1}}var ae,he,ct,ut,hn,le,Oe,dt,zt,Sn,jn,Jn,Gn,gn=V(()=>{"use strict";fn();ue();Z();ae=ie(re());Ht();z();yn();he=A(),ct=class extends Je{session;logger;constructor(e,t,n){super(t,n,!0),this.session=e;let r=ae.Sessions.getProjectService(this.session);this.logger=r?.logger??new je}logError(e,t){this.session.logError(e,t)}getFileAndProject(e){return ae.Sessions.getFileAndProject(this.session,e)}getPositionInFile(e,t){return ae.Sessions.getPositionInFile(this.session,e,t)}*getLanguageServices(e){let t=ae.Sessions.getProjectService(this.session);if(t!==void 0)if(e===void 0){for(let n of t.configuredProjects.values())yield n.getLanguageService();for(let n of t.inferredProjects)yield n.getLanguageService();for(let n of t.externalProjects)yield n.getLanguageService()}else{let n=he.server.toNormalizedPath(e.fileName),r=t.getScriptInfoForNormalizedPath(n);yield*r?r.containingProjects.map(o=>o.getLanguageService()):[]}}getScriptVersion(e){let t=he.server.toNormalizedPath(e.fileName),n=ae.Sessions.getProjectService(this.session);return n===void 0?void 0:n.getScriptInfoForNormalizedPath(t)?.getLatestVersion()}};(e=>{function d(t){let n=t;return n==null||typeof n!="object"||n.response===void 0||typeof n.response!="object"||typeof n.responseRequired!="boolean"?!1:n.response.error!==void 0&&typeof n.response.message=="string"}e.is=d})(ut||={});hn=!1,dt={kind:"error",message:"Attempt to install context handler failed"},zt=(d,e)=>{let t=Date.now();if(d===void 0)return{response:{error:"noArguments",message:"No arguments provided"},responseRequired:!0};let n=le?.getFileAndProject(d);if(n===void 0)return{response:{error:"noProject",message:"No project found"},responseRequired:!0};if(typeof d.line!="number"||typeof d.offset!="number")return{response:{error:"invalidArguments",message:"No project found"},responseRequired:!0};let{file:r,project:o}=n,s=le?.getPositionInFile(d,r);if(s===void 0)return{response:{error:"invalidPosition",message:"Position not valid"},responseRequired:!0};let l=d.startTime??t,c=typeof d.timeBudget=="number"?d.timeBudget:e;l+c>t&&(l=t,c=e);let f=o.getLanguageService(),S=f.getProgram();return S===void 0?{response:{error:"noProgram",message:"No program found"},responseRequired:!0}:{languageService:f,program:S,file:r,pos:s,timeBudget:c,startTime:l,requestStartTime:t}},Sn=d=>{if(!(d===void 0||d.lastSymbolRename===void 0))return{start:{line:d.lastSymbolRename.start.line-1,character:d.lastSymbolRename.start.character-1},end:{line:d.lastSymbolRename.end.line-1,character:d.lastSymbolRename.end.character-1}}},jn=d=>{let e=zt(d.arguments,100);if(ut.is(e))return e;let{languageService:t,file:n,pos:r,timeBudget:o,startTime:s,requestStartTime:l}=e,c=d.arguments,f=Date.now(),S=new Ne(typeof c.primaryCharacterBudget=="number"?c.primaryCharacterBudget:7*1024*4),b=new Ne(typeof c.secondaryCharacterBudget=="number"?c.secondaryCharacterBudget:8*1024*4),x=[];if(c.neighborFiles!==void 0)for(let M of c.neighborFiles)x.push(he.server.toNormalizedPath(M));let R=c.clientSideRunnableResults!==void 0?new Map(c.clientSideRunnableResults.map(M=>[M.id,M])):new Map,w=new ae.CancellationTokenWithTimer(Oe?.getCancellationToken?Oe.getCancellationToken():void 0,s,o,le?.host.isDebugging()??!1),X=new He(le,x,R,!!c.includeDocumentation),W=new ze(S,b,X);try{ln(W,le,t,n,r,w)}catch(M){if(!(M instanceof he.OperationCanceledException)&&!(M instanceof we))return M instanceof Error?{response:{error:"exception",message:M.message,stack:M.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}let E=Date.now();return W.addTimings(E-l,E-f),W.setTimedOut(w.isTimedOut()),{response:W.toJson(),responseRequired:!0}},Jn=d=>{let e=zt(d.arguments,50);if(ut.is(e))return e;let{languageService:t,file:n,pos:r,timeBudget:o,startTime:s}=e,l=Sn(d.arguments),c=new ae.CancellationTokenWithTimer(Oe?.getCancellationToken?Oe.getCancellationToken():void 0,s,o,le?.host.isDebugging()??!1),f=new ot;try{dn(f,le,t,n,r,d.arguments?.oldName,d.arguments?.newName,l,c)}catch(S){if(S instanceof he.OperationCanceledException)f.setCanRename("no","Operation canceled");else return S instanceof Error?{response:{error:"exception",message:S.message,stack:S.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}return f.setTimedOut(c.isTimedOut()),{response:f.toJsonResponse(),responseRequired:!0}},Gn=d=>{let e=zt(d.arguments,0);if(ut.is(e))return e;let{languageService:t,file:n,pos:r}=e,o=Sn(d.arguments),s;try{s=un(le,t,n,r,d.arguments?.oldName,d.arguments?.newName,o)}catch(l){return l instanceof Error?{response:{error:"exception",message:l.message,stack:l.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}return{response:{groups:s},responseRequired:!0}}});z();var xn=!1,Ut;function $n(d){if(!xn)try{A.install(d.typescript),Ut=(gn(),Nn(bn)).create}finally{xn=!0}if(Ut===void 0)throw new Error("Couldn't initialize TypeScript Context Server Plugin.");return{create:Ut}}module.exports=$n;
